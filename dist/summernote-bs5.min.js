/*! Summernote v0.9.1 | (c) 2013- Hackerwins and contributors | MIT license */
(function(){"use strict";$.summernote=$.summernote||{lang:{}},$.extend(!0,$.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size",sizeunit:"Font Size Unit"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize full",resizeHalf:"Resize half",resizeQuarter:"Resize quarter",resizeNone:"Original size",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Remove float",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image",original:"Original"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL",providers:"(YouTube, Google Drive, Vimeo, Vine, Instagram, DailyMotion, Youku, Peertube)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",addRowAbove:"Add row above",addRowBelow:"Add row below",addColLeft:"Add column left",addColRight:"Add column right",delRow:"Delete row",delCol:"Delete column",delTable:"Delete table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Text Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default",cpSelect:"Select"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{escape:"Escape",insertParagraph:"Insert Paragraph",undo:"Undo the last command",redo:"Redo the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"},output:{noSelection:"No Selection Made!"}}});const Rt=["sans-serif","serif","monospace","cursive","fantasy"];function Nt(i){return $.inArray(i.toLowerCase(),Rt)===-1?`'${i}'`:i}function ce(){const i="mw",t="20px";var n=document.createElement("canvas"),s=n.getContext("2d",{willReadFrequently:!0});n.width=40,n.height=20,s.textAlign="center",s.fillStyle="black",s.textBaseline="middle";function a(l,c){s.clearRect(0,0,40,20),s.font=t+" "+Nt(l)+', "'+c+'"',s.fillText(i,40/2,20/2);var h=s.getImageData(0,0,40,20).data;return h.join("")}return l=>{const c=l==="Comic Sans MS"?"Courier New":"Comic Sans MS";let h=a(c,c),d=a(l,c);return h!==d}}const B=navigator.userAgent,at=/MSIE|Trident/i.test(B);let lt;if(at){let i=/MSIE (\d+[.]\d+)/.exec(B);i&&(lt=parseFloat(i[1])),i=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(B),i&&(lt=parseFloat(i[1]))}const G=/Edge\/\d+/.test(B),he="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,de=at?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input",S={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:at,isEdge:G,isFF:!G&&/firefox/i.test(B),isPhantom:/PhantomJS/i.test(B),isWebkit:!G&&/webkit/i.test(B),isChrome:!G&&/chrome/i.test(B),isSafari:!G&&/safari/i.test(B)&&!/chrome/i.test(B),browserVersion:lt,isSupportTouch:he,isFontInstalled:ce(),isW3CRangeSupport:!!document.createRange,inputEventName:de,genericFontFamilies:Rt,validFontName:Nt};function ue(i){return function(t){return i===t}}function fe(i,t){return i===t}function pe(i){return function(t,e){return t[i]===e[i]}}function me(){return!0}function ge(){return!1}function be(i){return function(){return!i.apply(i,arguments)}}function ve(i,t){return function(e){return i(e)&&t(e)}}function Ce(i){return i}function ke(i,t){return function(){return i[t].apply(i,arguments)}}let It=0;function we(){It=0}function xe(i){const t=++It+"";return i?i+t:t}function ye(i){const t=$(document);return{top:i.top+t.scrollTop(),left:i.left+t.scrollLeft(),width:i.right-i.left,height:i.bottom-i.top}}function $e(i){const t={};for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[i[e]]=e);return t}function Se(i,t){return t=t||"",t+i.split(".").map(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}).join("")}function Te(i,t,e){let o;return function(){const n=this,s=arguments,a=()=>{o=null,e||i.apply(n,s)},l=e&&!o;clearTimeout(o),o=setTimeout(a,t),l&&i.apply(n,s)}}function Ee(i){return/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi.test(i)}const v={eq:ue,eq2:fe,peq2:pe,ok:me,fail:ge,self:Ce,not:be,and:ve,invoke:ke,resetUniqueId:we,uniqueId:xe,rect2bnd:ye,invertObject:$e,namespaceToCamel:Se,debounce:Te,isValidUrl:Ee};function At(i){return i[0]}function ct(i){return i[i.length-1]}function Re(i){return i.slice(0,i.length-1)}function Pt(i){return i.slice(1)}function Ne(i,t){for(let e=0,o=i.length;e<o;e++){const n=i[e];if(t(n))return n}}function Ie(i,t){for(let e=0,o=i.length;e<o;e++)if(!t(i[e]))return!1;return!0}function Lt(i,t){if(i&&i.length&&t){if(i.indexOf)return i.indexOf(t)!==-1;if(i.contains)return i.contains(t)}return!1}function Ae(i,t){return t=t||v.self,i.reduce(function(e,o){return e+t(o)},0)}function Pe(i){const t=[],e=i.length;let o=-1;for(;++o<e;)t[o]=i[o];return t}function Le(i){return!i||!i.length}function Fe(i,t){return i.length?Pt(i).reduce(function(o,n){const s=ct(o);return t(ct(s),n)?s[s.length]=n:o[o.length]=[n],o},[[At(i)]]):[]}function He(i){const t=[];for(let e=0,o=i.length;e<o;e++)i[e]&&t.push(i[e]);return t}function De(i){const t=[];for(let e=0,o=i.length;e<o;e++)Lt(t,i[e])||t.push(i[e]);return t}function Me(i,t){if(i&&i.length&&t){const e=i.indexOf(t);return e===-1?null:i[e+1]}return null}function ze(i,t){if(i&&i.length&&t){const e=i.indexOf(t);return e===-1?null:i[e-1]}return null}const u={head:At,last:ct,initial:Re,tail:Pt,prev:ze,next:Me,find:Ne,contains:Lt,all:Ie,sum:Ae,from:Pe,isEmpty:Le,clusterBy:Fe,compact:He,unique:De},ht="Â ",Be="\uFEFF";function H(i){return i&&$(i).hasClass("note-editable")}function Oe(i){return i&&$(i).hasClass("note-control-sizing")}function E(i){return i=i.toUpperCase(),function(t){return t&&t.nodeName.toUpperCase()===i}}function D(i){return i&&i.nodeType===3}function Ue(i){return i&&i.nodeType===1}function tt(i){return i&&/^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT|^AUDIO|^VIDEO|^EMBED/.test(i.nodeName.toUpperCase())}function q(i){return H(i)?!1:i&&/^DIV|^P|^LI|^H[1-7]/.test(i.nodeName.toUpperCase())}function je(i){return i&&/^H[1-7]/.test(i.nodeName.toUpperCase())}const We=E("PRE"),dt=E("LI");function Ke(i){return q(i)&&!dt(i)}const ut=E("TABLE"),Ft=E("DATA");function et(i){return!mt(i)&&!ft(i)&&!Ve(i)&&!q(i)&&!ut(i)&&!pt(i)&&!Ft(i)}function ft(i){return i&&/^UL|^OL/.test(i.nodeName.toUpperCase())}const Ve=E("HR");function Ht(i){return i&&/^TD|^TH/.test(i.nodeName.toUpperCase())}const pt=E("BLOCKQUOTE");function mt(i){return Ht(i)||pt(i)||H(i)}const Dt=E("A");function qe(i){return et(i)&&!!it(i,q)}function _e(i){return et(i)&&!it(i,q)}const Ge=E("BODY");function Ze(i,t){return i.nextSibling===t||i.previousSibling===t}function Ye(i,t){t=t||v.ok;const e=[];return i.previousSibling&&t(i.previousSibling)&&e.push(i.previousSibling),e.push(i),i.nextSibling&&t(i.nextSibling)&&e.push(i.nextSibling),e}const ot=S.isMSIE&&S.browserVersion<11?"&nbsp;":"<br>";function F(i){return D(i)?i.nodeValue.length:i?i.childNodes.length:0}function Xe(i){do if(i.firstElementChild===null||i.firstElementChild.innerHTML==="")break;while(i=i.firstElementChild);return _(i)}function _(i){const t=F(i);return t===0||!D(i)&&t===1&&i.innerHTML===ot?!0:!!(u.all(i.childNodes,D)&&i.innerHTML==="")}function Mt(i){!tt(i)&&!F(i)&&(i.innerHTML=ot)}function it(i,t){for(;i;){if(t(i))return i;if(H(i))break;i=i.parentNode}return null}function Qe(i,t){for(i=i.parentNode;i&&F(i)===1;){if(t(i))return i;if(H(i))break;i=i.parentNode}return null}function W(i,t){t=t||v.fail;const e=[];return it(i,function(o){return H(o)||e.push(o),t(o)}),e}function Je(i,t){const e=W(i);return u.last(e.filter(t))}function to(i,t){const e=W(i);for(let o=t;o;o=o.parentNode)if(e.indexOf(o)>-1)return o;return null}function eo(i,t){t=t||v.fail;const e=[];for(;i&&!t(i);)e.push(i),i=i.previousSibling;return e}function zt(i,t){t=t||v.fail;const e=[];for(;i&&!t(i);)e.push(i),i=i.nextSibling;return e}function oo(i,t){const e=[];return t=t||v.ok,function o(n){i!==n&&t(n)&&e.push(n);for(let s=0,a=n.childNodes.length;s<a;s++)o(n.childNodes[s])}(i),e}function io(i,t){const e=i.parentNode,o=$("<"+t+">")[0];return e.insertBefore(o,i),o.appendChild(i),o}function gt(i,t){const e=t.nextSibling;let o=t.parentNode;return e?o.insertBefore(i,e):o.appendChild(i),i}function bt(i,t,e){return $.each(t,function(o,n){!e&&dt(i)&&i.firstChild===null&&ft(n)&&i.appendChild(Ct("br")),i.appendChild(n)}),i}function nt(i){return i.offset===0}function Z(i){return i.offset===F(i.node)}function Bt(i){return nt(i)||Z(i)}function Ot(i,t){for(;i&&i!==t;){if(K(i)!==0)return!1;i=i.parentNode}return!0}function Ut(i,t){if(!t)return!1;for(;i&&i!==t;){if(K(i)!==F(i.parentNode)-1)return!1;i=i.parentNode}return!0}function no(i,t){return nt(i)&&Ot(i.node,t)}function so(i,t){return Z(i)&&Ut(i.node,t)}function K(i){let t=0;for(;i=i.previousSibling;)t+=1;return t}function Y(i){return!!(i&&i.childNodes&&i.childNodes.length)}function jt(i,t){let e,o;if(i.offset===0){if(H(i.node))return null;e=i.node.parentNode,o=K(i.node)}else Y(i.node)?(e=i.node.childNodes[i.offset-1],o=F(e)):(e=i.node,o=t?0:i.offset-1);return{node:e,offset:o}}function Wt(i,t){let e,o;if(F(i.node)===i.offset){if(H(i.node))return null;let n=Vt(i.node);n?(e=n,o=0):(e=i.node.parentNode,o=K(i.node)+1)}else Y(i.node)?(e=i.node.childNodes[i.offset],o=0):(e=i.node,o=t?F(i.node):i.offset+1);return{node:e,offset:o}}function Kt(i,t){let e,o=0;if(F(i.node)===i.offset){if(H(i.node))return null;e=i.node.parentNode,o=K(i.node)+1,H(e)&&(e=i.node.nextSibling,o=0)}else Y(i.node)?(e=i.node.childNodes[i.offset],o=0):(e=i.node,o=t?F(i.node):i.offset+1);return{node:e,offset:o}}function Vt(i){if(i.nextSibling&&i.parent===i.nextSibling.parent)return D(i.nextSibling)?i.nextSibling:Vt(i.nextSibling)}function qt(i,t){return i.node===t.node&&i.offset===t.offset}function ro(i){if(D(i.node)||!Y(i.node)||_(i.node))return!0;const t=i.node.childNodes[i.offset-1],e=i.node.childNodes[i.offset];return!!((!t||tt(t))&&(!e||tt(e))||ut(e))}function ao(i,t){for(;i;){if(t(i))return i;i=jt(i)}return null}function lo(i,t){for(;i;){if(t(i))return i;i=Wt(i)}return null}function co(i){if(!D(i.node))return!1;const t=i.node.nodeValue.charAt(i.offset-1);return t&&t!==" "&&t!==ht}function ho(i){if(!D(i.node))return!1;const t=i.node.nodeValue.charAt(i.offset-1);return t===" "||t===ht}function uo(i,t,e,o){let n=i;for(;n&&n.node&&(e(n),!qt(n,t));){const s=o&&i.node!==n.node&&t.node!==n.node;n=Kt(n,s)}}function fo(i,t){return W(t,v.eq(i)).map(K).reverse()}function po(i,t){let e=i;for(let o=0,n=t.length;o<n;o++)e.childNodes.length<=t[o]?e=e.childNodes[e.childNodes.length-1]:e=e.childNodes[t[o]];return e}function vt(i,t){let e=t&&t.isSkipPaddingBlankHTML;const o=t&&t.isNotSplitEdgePoint,n=t&&t.isDiscardEmptySplits;if(n&&(e=!0),Bt(i)&&(D(i.node)||o)){if(nt(i))return i.node;if(Z(i))return i.node.nextSibling}if(D(i.node))return i.node.splitText(i.offset);{const s=i.node.childNodes[i.offset];let a=zt(s);const l=gt(i.node.cloneNode(!1),i.node);return bt(l,a),e||(Mt(i.node),Mt(l)),n&&(_(i.node)&&X(i.node),_(l))?(X(l),i.node.nextSibling):l}}function _t(i,t,e){let o=W(t.node,v.eq(i));if(o.length){if(o.length===1)return vt(t,e)}else return null;if(o.length>2){let s=o.slice(0,o.length-1).find(a=>a.nextSibling);if(s&&t.offset!=0&&Z(t)){let a=s.nextSibling,l;a.nodeType==1?(l=a.childNodes[0],o=W(l,v.eq(i)),t={node:l,offset:0}):a.nodeType==3&&!a.data.match(/[\n\r]/g)&&(l=a,o=W(l,v.eq(i)),t={node:l,offset:0})}}return o.reduce(function(n,s){return n===t.node&&(n=vt(t,e)),vt({node:s,offset:n?K(n):F(s)},e)})}function mo(i,t){const e=t?q:mt,o=W(i.node,e),n=u.last(o)||i.node;let s,a;e(n)?(s=o[o.length-2],a=n):(s=n,a=s.parentNode);let l=s&&_t(s,i,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return!l&&a===i.node&&(l=i.node.childNodes[i.offset]),{rightNode:l,container:a}}function Ct(i){return document.createElement(i)}function go(i){return document.createTextNode(i)}function X(i,t){if(!i||!i.parentNode)return;if(i.removeNode)return i.removeNode(t);const e=i.parentNode;if(!t){const o=[];for(let n=0,s=i.childNodes.length;n<s;n++)o.push(i.childNodes[n]);for(let n=0,s=o.length;n<s;n++)e.insertBefore(o[n],i)}e.removeChild(i)}function bo(i,t){for(;i&&!(H(i)||!t(i));){const e=i.parentNode;X(i),i=e}}function vo(i,t){if(i.nodeName.toUpperCase()===t.toUpperCase())return i;const e=Ct(t);return i.style.cssText&&(e.style.cssText=i.style.cssText),bt(e,u.from(i.childNodes)),gt(e,i),X(i),e}const Gt=E("TEXTAREA");function Zt(i,t){const e=Gt(i[0])?i.val():i.html();return t?e.replace(/[\n\r]/g,""):e}function Co(i,t){let e=Zt(i);if(t){const o=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;e=e.replace(o,function(n,s,a){a=a.toUpperCase();const l=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(a)&&!!s,c=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(a);return n+(l||c?`
`:"")}),e=e.trim()}return e}function ko(i){const t=$(i),e=t.offset(),o=t.outerHeight(!0);return{left:e.left,top:e.top+o}}function wo(i,t){Object.keys(t).forEach(function(e){i.on(e,t[e])})}function xo(i,t){Object.keys(t).forEach(function(e){i.off(e,t[e])})}function yo(i){return i&&!D(i)&&u.contains(i.classList,"note-styletag")}const r={NBSP_CHAR:ht,ZERO_WIDTH_NBSP_CHAR:Be,blank:ot,emptyPara:`<p>${ot}</p>`,makePredByNodeName:E,isEditable:H,isControlSizing:Oe,isText:D,isElement:Ue,isVoid:tt,isPara:q,isPurePara:Ke,isHeading:je,isInline:et,isBlock:v.not(et),isBodyInline:_e,isBody:Ge,isParaInline:qe,isPre:We,isList:ft,isTable:ut,isData:Ft,isCell:Ht,isBlockquote:pt,isBodyContainer:mt,isAnchor:Dt,isDiv:E("DIV"),isLi:dt,isBR:E("BR"),isSpan:E("SPAN"),isB:E("B"),isU:E("U"),isS:E("S"),isI:E("I"),isImg:E("IMG"),isTextarea:Gt,deepestChildIsEmpty:Xe,isEmpty:_,isEmptyAnchor:v.and(Dt,_),isClosestSibling:Ze,withClosestSiblings:Ye,nodeLength:F,isLeftEdgePoint:nt,isRightEdgePoint:Z,isEdgePoint:Bt,isLeftEdgeOf:Ot,isRightEdgeOf:Ut,isLeftEdgePointOf:no,isRightEdgePointOf:so,prevPoint:jt,nextPoint:Wt,nextPointWithEmptyNode:Kt,isSamePoint:qt,isVisiblePoint:ro,prevPointUntil:ao,nextPointUntil:lo,isCharPoint:co,isSpacePoint:ho,walkPoint:uo,ancestor:it,singleChildAncestor:Qe,listAncestor:W,lastAncestor:Je,listNext:zt,listPrev:eo,listDescendant:oo,commonAncestor:to,wrap:io,insertAfter:gt,appendChildNodes:bt,position:K,hasChildren:Y,makeOffsetPath:fo,fromOffsetPath:po,splitTree:_t,splitPoint:mo,create:Ct,createText:go,remove:X,removeWhile:bo,replace:vo,html:Co,value:Zt,posFromPlaceholder:ko,attachEvents:wo,detachEvents:xo,isCustomStyleTag:yo};class $o{constructor(t,e){this.$note=t,this.memos={},this.modules={},this.layoutInfo={},this.options=$.extend(!0,{},e),$.summernote.ui=$.summernote.ui_template(this.options),this.ui=$.summernote.ui,this.initialize()}initialize(){return this.layoutInfo=this.ui.createLayout(this.$note),this._initialize(),this.$note.hide(),this}destroy(){this._destroy(),this.$note.removeData("summernote"),this.ui.removeLayout(this.$note,this.layoutInfo)}reset(){const t=this.isDisabled();this.code(r.emptyPara),this._destroy(),this._initialize(),t&&this.disable()}_initialize(){this.options.id=v.uniqueId($.now()),this.options.container=this.options.container||this.layoutInfo.editor;const t=$.extend({},this.options.buttons);Object.keys(t).forEach(o=>{this.memo("button."+o,t[o])});const e=$.extend({},this.options.modules,$.summernote.plugins||{});Object.keys(e).forEach(o=>{this.module(o,e[o],!0)}),Object.keys(this.modules).forEach(o=>{this.initializeModule(o)})}_destroy(){Object.keys(this.modules).reverse().forEach(t=>{this.removeModule(t)}),Object.keys(this.memos).forEach(t=>{this.removeMemo(t)}),this.triggerEvent("destroy",this)}code(t){const e=this.invoke("codeview.isActivated");if(t===void 0)return this.invoke("codeview.sync"),e?this.layoutInfo.codable.val():this.layoutInfo.editable.html();e?this.invoke("codeview.sync",t):this.layoutInfo.editable.html(t),this.$note.val(t),this.triggerEvent("change",t,this.layoutInfo.editable)}isDisabled(){return this.layoutInfo.editable.attr("contenteditable")==="false"}enable(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0),this.triggerEvent("disable",!1),this.options.editing=!0}disable(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.options.editing=!1,this.invoke("toolbar.deactivate",!0),this.triggerEvent("disable",!0)}triggerEvent(){const t=u.head(arguments),e=u.tail(u.from(arguments)),o=this.options.callbacks[v.namespaceToCamel(t,"on")];o&&o.apply(this.$note[0],e),this.$note.trigger("summernote."+t,e)}initializeModule(t){const e=this.modules[t];e.shouldInitialize=e.shouldInitialize||v.ok,e.shouldInitialize()&&(e.initialize&&e.initialize(),e.events&&r.attachEvents(this.$note,e.events))}module(t,e,o){if(arguments.length===1)return this.modules[t];this.modules[t]=new e(this),o||this.initializeModule(t)}removeModule(t){const e=this.modules[t];e.shouldInitialize()&&(e.events&&r.detachEvents(this.$note,e.events),e.destroy&&e.destroy()),delete this.modules[t]}memo(t,e){if(arguments.length===1)return this.memos[t];this.memos[t]=e}removeMemo(t){this.memos[t]&&this.memos[t].destroy&&this.memos[t].destroy(),delete this.memos[t]}createInvokeHandlerAndUpdateState(t,e){return o=>{this.createInvokeHandler(t,e)(o),this.invoke("buttons.updateCurrentStyle")}}createInvokeHandler(t,e){return o=>{o.preventDefault();const n=$(o.target);this.invoke(t,e||n.closest("[data-value]").data("value"),n)}}invoke(){const t=u.head(arguments),e=u.tail(u.from(arguments)),o=t.split("."),n=o.length>1,s=n&&u.head(o),a=n?u.last(o):u.head(o),l=this.modules[s||"editor"];if(!s&&this[a])return this[a].apply(this,e);if(l&&l[a]&&l.shouldInitialize())return l[a].apply(l,e)}}$.fn.extend({summernote:function(){const i=typeof u.head(arguments),t=i==="string",e=i==="object",o=$.extend({},$.summernote.options,e?u.head(arguments):{});o.langInfo=$.extend(!0,{},$.summernote.lang["en-US"],$.summernote.lang[o.lang]),o.icons=$.extend(!0,{},$.summernote.options.icons,o.icons),o.tooltip=o.tooltip==="auto"?!S.isSupportTouch:o.tooltip,this.each((s,a)=>{const l=$(a);if(!l.data("summernote")){const c=new $o(l,o);l.data("summernote",c),l.data("summernote").triggerEvent("init",c.layoutInfo)}});const n=this.first();if(n.length){const s=n.data("summernote");if(t)return s.invoke.apply(s,u.from(arguments));o.focus&&s.invoke("editor.focus")}return this}});function Yt(i,t){let e=i.parentElement(),o;const n=document.body.createTextRange();let s;const a=u.from(e.childNodes);for(o=0;o<a.length;o++)if(!r.isText(a[o])){if(n.moveToElementText(a[o]),n.compareEndPoints("StartToStart",i)>=0)break;s=a[o]}if(o!==0&&r.isText(a[o-1])){const l=document.body.createTextRange();let c=null;l.moveToElementText(s||e),l.collapse(!s),c=s?s.nextSibling:e.firstChild;const h=i.duplicate();h.setEndPoint("StartToStart",l);let d=h.text.replace(/[\r\n]/g,"").length;for(;d>c.nodeValue.length&&c.nextSibling;)d-=c.nodeValue.length,c=c.nextSibling;c.nodeValue,t&&c.nextSibling&&r.isText(c.nextSibling)&&d===c.nodeValue.length&&(d-=c.nodeValue.length,c=c.nextSibling),e=c,o=d}return{cont:e,offset:o}}function Xt(i){const t=function(n,s){let a,l;if(r.isText(n)){const c=r.listPrev(n,v.not(r.isText)),h=u.last(c).previousSibling;a=h||n.parentNode,s+=u.sum(u.tail(c),r.nodeLength),l=!h}else{if(a=n.childNodes[s]||n,r.isText(a))return t(a,0);s=0,l=!1}return{node:a,collapseToStart:l,offset:s}},e=document.body.createTextRange(),o=t(i.node,i.offset);return e.moveToElementText(o.node),e.collapse(o.collapseToStart),e.moveStart("character",o.offset),e}class R{constructor(t,e,o,n){this.sc=t,this.so=e,this.ec=o,this.eo=n,this.isOnEditable=this.makeIsOn(r.isEditable),this.isOnList=this.makeIsOn(r.isList),this.isOnAnchor=this.makeIsOn(r.isAnchor),this.isOnCell=this.makeIsOn(r.isCell),this.isOnData=this.makeIsOn(r.isData)}nativeRange(){if(S.isW3CRangeSupport){const t=document.createRange();return t.setStart(this.sc,this.so),t.setEnd(this.ec,this.eo),t}else{const t=Xt({node:this.sc,offset:this.so});return t.setEndPoint("EndToEnd",Xt({node:this.ec,offset:this.eo})),t}}getPoints(){return{sc:this.sc,so:this.so,ec:this.ec,eo:this.eo}}getStartPoint(){return{node:this.sc,offset:this.so}}getEndPoint(){return{node:this.ec,offset:this.eo}}select(){const t=this.nativeRange();if(S.isW3CRangeSupport){const e=document.getSelection();e.rangeCount>0&&e.removeAllRanges(),e.addRange(t)}else t.select();return this}scrollIntoView(t){const e=$(t).height();return t.scrollTop+e<this.sc.offsetTop&&(t.scrollTop+=Math.abs(t.scrollTop+e-this.sc.offsetTop)),this}normalize(){const t=function(n,s){if(!n||r.isVisiblePoint(n)&&(!r.isEdgePoint(n)||r.isRightEdgePoint(n)&&!s||r.isLeftEdgePoint(n)&&s||r.isRightEdgePoint(n)&&s&&r.isVoid(n.node.nextSibling)||r.isLeftEdgePoint(n)&&!s&&r.isVoid(n.node.previousSibling)||r.isBlock(n.node)&&r.isEmpty(n.node)))return n;const a=r.ancestor(n.node,r.isBlock);let l=!1;if(!l){const d=r.prevPoint(n)||{node:null};l=(r.isLeftEdgePointOf(n,a)||r.isVoid(d.node))&&!s}let c=!1;if(!c){const d=r.nextPoint(n)||{node:null};c=(r.isRightEdgePointOf(n,a)||r.isVoid(d.node))&&s}if(l||c){if(r.isVisiblePoint(n))return n;s=!s}return(s?r.nextPointUntil(r.nextPoint(n),r.isVisiblePoint):r.prevPointUntil(r.prevPoint(n),r.isVisiblePoint))||n},e=t(this.getEndPoint(),!1),o=this.isCollapsed()?e:t(this.getStartPoint(),!0);return new R(o.node,o.offset,e.node,e.offset)}nodes(t,e){t=t||v.ok;const o=e&&e.includeAncestor,n=e&&e.fullyContains,s=this.getStartPoint(),a=this.getEndPoint(),l=[],c=[];return r.walkPoint(s,a,function(h){if(r.isEditable(h.node))return;let d;n?(r.isLeftEdgePoint(h)&&c.push(h.node),r.isRightEdgePoint(h)&&u.contains(c,h.node)&&(d=h.node)):o?d=r.ancestor(h.node,t):d=h.node,d&&t(d)&&l.push(d)},!0),u.unique(l)}commonAncestor(){return r.commonAncestor(this.sc,this.ec)}expand(t){const e=r.ancestor(this.sc,t),o=r.ancestor(this.ec,t);if(!e&&!o)return new R(this.sc,this.so,this.ec,this.eo);const n=this.getPoints();return e&&(n.sc=e,n.so=0),o&&(n.ec=o,n.eo=r.nodeLength(o)),new R(n.sc,n.so,n.ec,n.eo)}collapse(t){return t?new R(this.sc,this.so,this.sc,this.so):new R(this.ec,this.eo,this.ec,this.eo)}splitText(){const t=this.sc===this.ec,e=this.getPoints();return r.isText(this.ec)&&!r.isEdgePoint(this.getEndPoint())&&this.ec.splitText(this.eo),r.isText(this.sc)&&!r.isEdgePoint(this.getStartPoint())&&(e.sc=this.sc.splitText(this.so),e.so=0,t&&(e.ec=e.sc,e.eo=this.eo-this.so)),new R(e.sc,e.so,e.ec,e.eo)}deleteContents(){if(this.isCollapsed())return this;const t=this.splitText(),e=t.nodes(null,{fullyContains:!0}),o=r.prevPointUntil(t.getStartPoint(),function(s){return!u.contains(e,s.node)}),n=[];return $.each(e,function(s,a){const l=a.parentNode;o.node!==l&&r.nodeLength(l)===1&&n.push(l),r.remove(a,!1)}),$.each(n,function(s,a){r.remove(a,!1)}),new R(o.node,o.offset,o.node,o.offset).normalize()}makeIsOn(t){return function(){const e=r.ancestor(this.sc,t);return!!e&&e===r.ancestor(this.ec,t)}}isLeftEdgeOf(t){if(!r.isLeftEdgePoint(this.getStartPoint()))return!1;const e=r.ancestor(this.sc,t);return e&&r.isLeftEdgeOf(this.sc,e)}isCollapsed(){return this.sc===this.ec&&this.so===this.eo}wrapBodyInlineWithPara(){if(r.isBodyContainer(this.sc)&&r.isEmpty(this.sc))return this.sc.innerHTML=r.emptyPara,new R(this.sc.firstChild,0,this.sc.firstChild,0);const t=this.normalize();if(r.isParaInline(this.sc)||r.isPara(this.sc))return t;let e;if(r.isInline(t.sc)){const o=r.listAncestor(t.sc,v.not(r.isInline));e=u.last(o),r.isInline(e)||(e=o[o.length-2]||t.sc.childNodes[t.so])}else e=t.sc.childNodes[t.so>0?t.so-1:0];if(e){let o=r.listPrev(e,r.isParaInline).reverse();if(o=o.concat(r.listNext(e.nextSibling,r.isParaInline)),o.length){const n=r.wrap(u.head(o),"p");r.appendChildNodes(n,u.tail(o))}}return this.normalize()}insertNode(t,e=!1){let o=this;(r.isText(t)||r.isInline(t))&&(o=this.wrapBodyInlineWithPara().deleteContents());const n=r.splitPoint(o.getStartPoint(),r.isInline(t));return n.rightNode?(n.rightNode.parentNode.insertBefore(t,n.rightNode),r.isEmpty(n.rightNode)&&(e||r.isPara(t))&&n.rightNode.parentNode.removeChild(n.rightNode)):n.container.appendChild(t),t}pasteHTML(t){t=((t||"")+"").trim(t);const e=$("<div></div>").html(t)[0];let o=u.from(e.childNodes);const n=this;let s=!1;return n.so>=0&&(o=o.reverse(),s=!0),o=o.map(function(a){return n.insertNode(a,!r.isInline(a))}),s&&(o=o.reverse()),o}toString(){const t=this.nativeRange();return S.isW3CRangeSupport?t.toString():t.text}getWordRange(t){let e=this.getEndPoint();if(!r.isCharPoint(e))return this;const o=r.prevPointUntil(e,function(n){return!r.isCharPoint(n)});return t&&(e=r.nextPointUntil(e,function(n){return!r.isCharPoint(n)})),new R(o.node,o.offset,e.node,e.offset)}getWordsRange(t){var e=this.getEndPoint(),o=function(s){return!r.isCharPoint(s)&&!r.isSpacePoint(s)};if(o(e))return this;var n=r.prevPointUntil(e,o);return t&&(e=r.nextPointUntil(e,o)),new R(n.node,n.offset,e.node,e.offset)}getWordsMatchRange(t){var e=this.getEndPoint(),o=r.prevPointUntil(e,function(l){if(!r.isCharPoint(l)&&!r.isSpacePoint(l))return!0;var c=new R(l.node,l.offset,e.node,e.offset),h=t.exec(c.toString());return h&&h.index===0}),n=new R(o.node,o.offset,e.node,e.offset),s=n.toString(),a=t.exec(s);return a&&a[0].length===s.length?n:null}bookmark(t){return{s:{path:r.makeOffsetPath(t,this.sc),offset:this.so},e:{path:r.makeOffsetPath(t,this.ec),offset:this.eo}}}paraBookmark(t){return{s:{path:u.tail(r.makeOffsetPath(u.head(t),this.sc)),offset:this.so},e:{path:u.tail(r.makeOffsetPath(u.last(t),this.ec)),offset:this.eo}}}getClientRects(){return this.nativeRange().getClientRects()}}const k={create:function(i,t,e,o){if(arguments.length===4)return new R(i,t,e,o);if(arguments.length===2)return e=i,o=t,new R(i,t,e,o);{let n=this.createFromSelection();if(!n&&arguments.length===1){let s=arguments[0];return r.isEditable(s)&&(s=s.lastChild),this.createFromBodyElement(s,r.emptyPara===arguments[0].innerHTML)}return n}},createFromBodyElement:function(i,t=!1){var e=this.createFromNode(i);return e.collapse(t)},createFromSelection:function(){let i,t,e,o;if(S.isW3CRangeSupport){const n=document.getSelection();if(!n||n.rangeCount===0)return null;if(r.isBody(n.anchorNode))return null;const s=n.getRangeAt(0);i=s.startContainer,t=s.startOffset,e=s.endContainer,o=s.endOffset}else{const n=document.selection.createRange(),s=n.duplicate();s.collapse(!1);const a=n;a.collapse(!0);let l=Yt(a,!0),c=Yt(s,!1);r.isText(l.node)&&r.isLeftEdgePoint(l)&&r.isTextNode(c.node)&&r.isRightEdgePoint(c)&&c.node.nextSibling===l.node&&(l=c),i=l.cont,t=l.offset,e=c.cont,o=c.offset}return new R(i,t,e,o)},createFromNode:function(i){let t=i,e=0,o=i,n=r.nodeLength(o);return r.isVoid(t)&&(e=r.listPrev(t).length-1,t=t.parentNode),r.isBR(o)?(n=r.listPrev(o).length-1,o=o.parentNode):r.isVoid(o)&&(n=r.listPrev(o).length,o=o.parentNode),this.create(t,e,o,n)},createFromNodeBefore:function(i){return this.createFromNode(i).collapse(!0)},createFromNodeAfter:function(i){return this.createFromNode(i).collapse()},createFromBookmark:function(i,t){const e=r.fromOffsetPath(i,t.s.path),o=t.s.offset,n=r.fromOffsetPath(i,t.e.path),s=t.e.offset;return new R(e,o,n,s)},createFromParaBookmark:function(i,t){const e=i.s.offset,o=i.e.offset,n=r.fromOffsetPath(u.head(t),i.s.path),s=r.fromOffsetPath(u.last(t),i.e.path);return new R(n,e,s,o)}},N={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221,HOME:36,END:35,PAGEUP:33,PAGEDOWN:34},w={isEdit:i=>u.contains([N.BACKSPACE,N.TAB,N.ENTER,N.SPACE,N.DELETE],i),isRemove:i=>u.contains([N.BACKSPACE,N.DELETE],i),isMove:i=>u.contains([N.LEFT,N.UP,N.RIGHT,N.DOWN],i),isNavigation:i=>u.contains([N.HOME,N.END,N.PAGEUP,N.PAGEDOWN],i),nameFromCode:v.invertObject(N),code:N};function So(i){return $.Deferred(t=>{$.extend(new FileReader,{onload:e=>{const o=e.target.result;t.resolve(o)},onerror:e=>{t.reject(e)}}).readAsDataURL(i)}).promise()}function To(i){return $.Deferred(t=>{const e=$("<img>");e.one("load",()=>{e.off("error abort"),t.resolve(e)}).one("error abort",()=>{e.off("load").detach(),t.reject(e)}).css({display:"none"}).appendTo(document.body).attr("src",i)}).promise()}class Eo{constructor(t){this.stack=[],this.stackOffset=-1,this.context=t,this.$editable=t.layoutInfo.editable,this.editable=this.$editable[0]}makeSnapshot(){const t=k.create(this.editable),e={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:this.$editable.html(),bookmark:t&&t.isOnEditable()?t.bookmark(this.editable):e}}applySnapshot(t){t.contents!==null&&this.$editable.html(t.contents),t.bookmark!==null&&k.createFromBookmark(this.editable,t.bookmark).select()}rewind(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset=0,this.applySnapshot(this.stack[this.stackOffset])}commit(){this.stack=[],this.stackOffset=-1,this.recordUndo()}reset(){this.stack=[],this.stackOffset=-1,this.$editable.html(""),this.recordUndo()}undo(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset>0&&(this.stackOffset--,this.applySnapshot(this.stack[this.stackOffset]))}redo(){this.stack.length-1>this.stackOffset&&(this.stackOffset++,this.applySnapshot(this.stack[this.stackOffset]))}recordUndo(){this.stackOffset++,this.stack.length>this.stackOffset&&(this.stack=this.stack.slice(0,this.stackOffset)),this.stack.push(this.makeSnapshot()),this.stack.length>this.context.options.historyLimit&&(this.stack.shift(),this.stackOffset-=1)}}class Ro{jQueryCSS(t,e){const o={};return $.each(e,(n,s)=>{o[s]=t.css(s)}),o}fromNode(t){const e=["font-family","font-size","text-align","list-style-type","line-height"],o=this.jQueryCSS(t,e)||{},n=t[0].style.fontSize||o["font-size"];return o["font-size"]=parseInt(n,10),o["font-size-unit"]=n.match(/[a-z%]+$/),o}stylePara(t,e){$.each(t.nodes(r.isPara,{includeAncestor:!0}),(o,n)=>{$(n).css(e)})}styleNodes(t,e){t=t.splitText();const o=e&&e.nodeName||"SPAN",n=!!(e&&e.expandClosestSibling),s=!!(e&&e.onlyPartialContains);if(t.isCollapsed())return[t.insertNode(r.create(o))];let a=r.makePredByNodeName(o);const l=t.nodes(r.isText,{fullyContains:!0}).map(c=>r.singleChildAncestor(c,a)||r.wrap(c,o));if(n){if(s){const c=t.nodes();a=v.and(a,h=>u.contains(c,h))}return l.map(c=>{const h=r.withClosestSiblings(c,a),d=u.head(h),f=u.tail(h);return $.each(f,(C,b)=>{r.appendChildNodes(d,b.childNodes),r.remove(b)}),u.head(h)})}else return l}current(t){const e=$(r.isElement(t.sc)?t.sc:t.sc.parentNode);let o=this.fromNode(e);try{o=$.extend(o,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal","font-family":document.queryCommandValue("fontname")||o["font-family"]})}catch{}if(!t.isOnList())o["list-style"]="none";else{const a=["circle","disc","disc-leading-zero","square"].indexOf(o["list-style-type"])>-1;o["list-style"]=a?"unordered":"ordered"}const n=r.ancestor(t.sc,r.isPara);if(n&&n.style["line-height"])o["line-height"]=n.style.lineHeight;else{const s=parseInt(o["line-height"],10)/parseInt(o["font-size"],10);o["line-height"]=s.toFixed(1)}return o.anchor=t.isOnAnchor()&&r.ancestor(t.sc,r.isAnchor),o.ancestors=r.listAncestor(t.sc,r.isEditable),o.range=t,o}}class Qt{insertOrderedList(t){this.toggleList("OL",t)}insertUnorderedList(t){this.toggleList("UL",t)}indent(t){const e=k.create(t).wrapBodyInlineWithPara(),o=e.nodes(r.isPara,{includeAncestor:!0}),n=u.clusterBy(o,v.peq2("parentNode"));$.each(n,(s,a)=>{const l=u.head(a);if(r.isLi(l)){const c=this.findList(l.previousSibling);c?a.map(h=>c.appendChild(h)):(this.wrapList(a,l.parentNode.nodeName),a.map(h=>h.parentNode).map(h=>this.appendToPrevious(h)))}else $.each(a,(c,h)=>{$(h).css("marginLeft",(d,f)=>(parseInt(f,10)||0)+25)})}),e.select()}outdent(t){const e=k.create(t).wrapBodyInlineWithPara(),o=e.nodes(r.isPara,{includeAncestor:!0}),n=u.clusterBy(o,v.peq2("parentNode"));$.each(n,(s,a)=>{const l=u.head(a);r.isLi(l)?this.releaseList([a]):$.each(a,(c,h)=>{$(h).css("marginLeft",(d,f)=>(f=parseInt(f,10)||0,f>25?f-25:""))})}),e.select()}toggleList(t,e){const o=k.create(e).wrapBodyInlineWithPara();let n=o.nodes(r.isPara,{includeAncestor:!0});const s=o.paraBookmark(n),a=u.clusterBy(n,v.peq2("parentNode"));if(u.find(n,r.isPurePara)){let l=[];$.each(a,(c,h)=>{l=l.concat(this.wrapList(h,t))}),n=l}else{const l=o.nodes(r.isList,{includeAncestor:!0}).filter(c=>!$.nodeName(c,t));l.length?$.each(l,(c,h)=>{r.replace(h,t)}):n=this.releaseList(a,!0)}k.createFromParaBookmark(s,n).select()}wrapList(t,e){const o=u.head(t),n=u.last(t),s=r.isList(o.previousSibling)&&o.previousSibling,a=r.isList(n.nextSibling)&&n.nextSibling,l=s||r.insertAfter(r.create(e||"UL"),n);return t=t.map(c=>r.isPurePara(c)?r.replace(c,"LI"):c),r.appendChildNodes(l,t,!0),a&&(r.appendChildNodes(l,u.from(a.childNodes),!0),r.remove(a)),t}releaseList(t,e){let o=[];return $.each(t,(n,s)=>{const a=u.head(s),l=u.last(s),c=e?r.lastAncestor(a,r.isList):a.parentNode,h=c.parentNode;if(c.parentNode.nodeName==="LI")s.map(d=>{const f=this.findNextSiblings(d);h.nextSibling?h.parentNode.insertBefore(d,h.nextSibling):h.parentNode.appendChild(d),f.length&&(this.wrapList(f,c.nodeName),d.appendChild(f[0].parentNode))}),c.children.length===0&&h.removeChild(c),h.childNodes.length===0&&h.parentNode.removeChild(h);else{const d=c.childNodes.length>1?r.splitTree(c,{node:l.parentNode,offset:r.position(l)+1},{isSkipPaddingBlankHTML:!0}):null,f=r.splitTree(c,{node:a.parentNode,offset:r.position(a)},{isSkipPaddingBlankHTML:!0});s=e?r.listDescendant(f,r.isLi):u.from(f.childNodes).filter(r.isLi),(e||!r.isList(c.parentNode))&&(s=s.map(b=>r.replace(b,"P"))),$.each(u.from(s).reverse(),(b,T)=>{r.insertAfter(T,c)});const C=u.compact([c,f,d]);$.each(C,(b,T)=>{const A=[T].concat(r.listDescendant(T,r.isList));$.each(A.reverse(),(O,p)=>{r.nodeLength(p)||r.remove(p,!0)})})}o=o.concat(s)}),o}appendToPrevious(t){return t.previousSibling?r.appendChildNodes(t.previousSibling,[t]):this.wrapList([t],"LI")}findList(t){return t?u.find(t.children,e=>["OL","UL"].indexOf(e.nodeName)>-1):null}findNextSiblings(t){const e=[];for(;t.nextSibling;)e.push(t.nextSibling),t=t.nextSibling;return e}}class No{constructor(t){this.bullet=new Qt,this.options=t.options}insertTab(t,e){const o=r.createText(new Array(e+1).join(r.NBSP_CHAR));t=t.deleteContents(),t.insertNode(o,!0),t=k.create(o,e),t.select()}insertParagraph(t,e){e=e||k.create(t),e=e.deleteContents(),e=e.wrapBodyInlineWithPara();const o=r.ancestor(e.sc,r.isPara);let n;if(o)if(r.isLi(o)&&(r.isEmpty(o)||r.deepestChildIsEmpty(o))){this.bullet.toggleList(o.parentNode.nodeName);return}else{let s=null;if(this.options.blockquoteBreakingLevel===1?s=r.ancestor(o,r.isBlockquote):this.options.blockquoteBreakingLevel===2&&(s=r.lastAncestor(o,r.isBlockquote)),s){n=$(r.emptyPara)[0],r.isRightEdgePoint(e.getStartPoint())&&r.isBR(e.sc.nextSibling)&&$(e.sc.nextSibling).remove();const a=r.splitTree(s,e.getStartPoint(),{isDiscardEmptySplits:!0});a?a.parentNode.insertBefore(n,a):r.insertAfter(n,s)}else{n=r.splitTree(o,e.getStartPoint());let a=r.listDescendant(o,r.isEmptyAnchor);a=a.concat(r.listDescendant(n,r.isEmptyAnchor)),$.each(a,(l,c)=>{r.remove(c)}),(r.isHeading(n)||r.isPre(n)||r.isCustomStyleTag(n))&&r.isEmpty(n)&&(n=r.replace(n,"p"))}}else{const s=e.sc.childNodes[e.so];n=$(r.emptyPara)[0],s?e.sc.insertBefore(n,s):e.sc.appendChild(n)}k.create(n,0).normalize().select().scrollIntoView(t)}}const g=function(i,t,e,o){const n={colPos:0,rowPos:0},s=[],a=[];function l(){!i||!i.tagName||i.tagName.toLowerCase()!=="td"&&i.tagName.toLowerCase()!=="th"||(n.colPos=i.cellIndex,!(!i.parentElement||!i.parentElement.tagName||i.parentElement.tagName.toLowerCase()!=="tr")&&(n.rowPos=i.parentElement.rowIndex))}function c(p,m,x,y,U,M,j){const z={baseRow:x,baseCell:y,isRowSpan:U,isColSpan:M,isVirtual:j};s[p]||(s[p]=[]),s[p][m]=z}function h(p,m,x,y){return{baseCell:p.baseCell,action:m,virtualTable:{rowIndex:x,cellIndex:y}}}function d(p,m){if(!s[p]||!s[p][m])return m;let x=m;for(;s[p][x];)if(x++,!s[p][x])return x}function f(p,m){const x=d(p.rowIndex,m.cellIndex),y=m.colSpan>1,U=m.rowSpan>1,M=p.rowIndex===n.rowPos&&m.cellIndex===n.colPos;c(p.rowIndex,x,p,m,U,y,!1);const j=m.attributes.rowSpan?parseInt(m.attributes.rowSpan.value,10):0;if(j>1)for(let P=1;P<j;P++){const V=p.rowIndex+P;C(V,x,m,M),c(V,x,p,m,!0,y,!0)}const z=m.attributes.colSpan?parseInt(m.attributes.colSpan.value,10):0;if(z>1)for(let P=1;P<z;P++){const V=d(p.rowIndex,x+P);C(p.rowIndex,V,m,M),c(p.rowIndex,V,p,m,U,!0,!0)}}function C(p,m,x,y){p===n.rowPos&&n.colPos>=x.cellIndex&&x.cellIndex<=m&&!y&&n.colPos++}function b(){const p=o.rows;for(let m=0;m<p.length;m++){const x=p[m].cells;for(let y=0;y<x.length;y++)f(p[m],x[y])}}function T(p){switch(t){case g.where.Column:if(p.isColSpan)return g.resultAction.SubtractSpanCount;break;case g.where.Row:if(!p.isVirtual&&p.isRowSpan)return g.resultAction.AddCell;if(p.isRowSpan)return g.resultAction.SubtractSpanCount;break}return g.resultAction.RemoveCell}function A(p){switch(t){case g.where.Column:if(p.isColSpan)return g.resultAction.SumSpanCount;if(p.isRowSpan&&p.isVirtual)return g.resultAction.Ignore;break;case g.where.Row:if(p.isRowSpan)return g.resultAction.SumSpanCount;if(p.isColSpan&&p.isVirtual)return g.resultAction.Ignore;break}return g.resultAction.AddCell}function O(){l(),b()}this.getActionList=function(){const p=t===g.where.Row?n.rowPos:-1,m=t===g.where.Column?n.colPos:-1;let x=0,y=!0;for(;y;){const U=p>=0?p:x,M=m>=0?m:x,j=s[U];if(!j)return y=!1,a;const z=j[M];if(!z)return y=!1,a;let P=g.resultAction.Ignore;switch(e){case g.requestAction.Add:P=A(z);break;case g.requestAction.Delete:P=T(z);break}a.push(h(z,P,U,M)),x++}return a},O()};g.where={Row:0,Column:1},g.requestAction={Add:0,Delete:1},g.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4};class Io{tab(t,e){const o=r.ancestor(t.commonAncestor(),r.isCell),n=r.ancestor(o,r.isTable),s=r.listDescendant(n,r.isCell),a=u[e?"prev":"next"](s,o);a&&k.create(a,0).select()}addRow(t,e){const o=r.ancestor(t.commonAncestor(),r.isCell),n=$(o).closest("tr"),s=this.recoverAttributes(n),a=$("<tr"+s+"></tr>"),c=new g(o,g.where.Row,g.requestAction.Add,$(n).closest("table")[0]).getActionList();for(let h=0;h<c.length;h++){const d=c[h],f=this.recoverAttributes(d.baseCell);switch(d.action){case g.resultAction.AddCell:a.append("<td"+f+">"+r.blank+"</td>");break;case g.resultAction.SumSpanCount:{if(e==="top"&&(d.baseCell.parent?d.baseCell.closest("tr").rowIndex:0)<=n[0].rowIndex){const A=$("<div></div>").append($("<td"+f+">"+r.blank+"</td>").removeAttr("rowspan")).html();a.append(A);break}let C=parseInt(d.baseCell.rowSpan,10);C++,d.baseCell.setAttribute("rowSpan",C)}break}}if(e==="top")n.before(a);else{if(o.rowSpan>1){const d=n[0].rowIndex+(o.rowSpan-2);$($(n).parent().find("tr")[d]).after($(a));return}n.after(a)}}addCol(t,e){const o=r.ancestor(t.commonAncestor(),r.isCell),n=$(o).closest("tr");$(n).siblings().push(n);const l=new g(o,g.where.Column,g.requestAction.Add,$(n).closest("table")[0]).getActionList();for(let c=0;c<l.length;c++){const h=l[c],d=this.recoverAttributes(h.baseCell);switch(h.action){case g.resultAction.AddCell:e==="right"?$(h.baseCell).after("<td"+d+">"+r.blank+"</td>"):$(h.baseCell).before("<td"+d+">"+r.blank+"</td>");break;case g.resultAction.SumSpanCount:if(e==="right"){let f=parseInt(h.baseCell.colSpan,10);f++,h.baseCell.setAttribute("colSpan",f)}else $(h.baseCell).before("<td"+d+">"+r.blank+"</td>");break}}}recoverAttributes(t){let e="";if(!t)return e;const o=t.attributes||[];for(let n=0;n<o.length;n++)o[n].name.toLowerCase()!=="id"&&o[n].specified&&(e+=" "+o[n].name+"='"+o[n].value+"'");return e}deleteRow(t){const e=r.ancestor(t.commonAncestor(),r.isCell),o=$(e).closest("tr"),n=o.children("td, th").index($(e)),s=o[0].rowIndex,l=new g(e,g.where.Row,g.requestAction.Delete,$(o).closest("table")[0]).getActionList();for(let c=0;c<l.length;c++){if(!l[c])continue;const h=l[c].baseCell,d=l[c].virtualTable,f=h.rowSpan&&h.rowSpan>1;let C=f?parseInt(h.rowSpan,10):0;switch(l[c].action){case g.resultAction.Ignore:continue;case g.resultAction.AddCell:{const b=o.next("tr")[0];if(!b)continue;const T=o[0].cells[n];f&&(C>2?(C--,b.insertBefore(T,b.cells[n]),b.cells[n].setAttribute("rowSpan",C),b.cells[n].innerHTML=""):C===2&&(b.insertBefore(T,b.cells[n]),b.cells[n].removeAttribute("rowSpan"),b.cells[n].innerHTML=""))}continue;case g.resultAction.SubtractSpanCount:f&&(C>2?(C--,h.setAttribute("rowSpan",C),d.rowIndex!==s&&h.cellIndex===n&&(h.innerHTML="")):C===2&&(h.removeAttribute("rowSpan"),d.rowIndex!==s&&h.cellIndex===n&&(h.innerHTML="")));continue;case g.resultAction.RemoveCell:continue}}o.remove()}deleteCol(t){const e=r.ancestor(t.commonAncestor(),r.isCell),o=$(e).closest("tr"),n=o.children("td, th").index($(e)),a=new g(e,g.where.Column,g.requestAction.Delete,$(o).closest("table")[0]).getActionList();for(let l=0;l<a.length;l++)if(a[l])switch(a[l].action){case g.resultAction.Ignore:continue;case g.resultAction.SubtractSpanCount:{const c=a[l].baseCell;if(c.colSpan&&c.colSpan>1){let d=c.colSpan?parseInt(c.colSpan,10):0;d>2?(d--,c.setAttribute("colSpan",d),c.cellIndex===n&&(c.innerHTML="")):d===2&&(c.removeAttribute("colSpan"),c.cellIndex===n&&(c.innerHTML=""))}}continue;case g.resultAction.RemoveCell:r.remove(a[l].baseCell,!0);continue}}createTable(t,e,o){const n=[];let s;for(let h=0;h<t;h++)n.push("<td>"+r.blank+"</td>");s=n.join("");const a=[];let l;for(let h=0;h<e;h++)a.push("<tr>"+s+"</tr>");l=a.join("");const c=$("<table>"+l+"</table>");return o&&o.tableClassName&&c.addClass(o.tableClassName),c[0]}deleteTable(t){const e=r.ancestor(t.commonAncestor(),r.isCell);$(e).closest("table").remove()}}const Ao="bogus",Po=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,Lo=/^(\+?\d{1,3}[\s-]?)?(\d{1,4})[\s-]?(\d{1,4})[\s-]?(\d{1,4})$/,Fo=/^([A-Za-z][A-Za-z0-9+-.]*\:|#|\/)/;class Ho{constructor(t){this.context=t,this.$note=t.layoutInfo.note,this.$editor=t.layoutInfo.editor,this.$editable=t.layoutInfo.editable,this.options=t.options,this.lang=this.options.langInfo,this.editable=this.$editable[0],this.lastRange=null,this.snapshot=null,this.style=new Ro,this.table=new Io,this.typing=new No(t),this.bullet=new Qt,this.history=new Eo(t),this.context.memo("help.escape",this.lang.help.escape),this.context.memo("help.undo",this.lang.help.undo),this.context.memo("help.redo",this.lang.help.redo),this.context.memo("help.tab",this.lang.help.tab),this.context.memo("help.untab",this.lang.help.untab),this.context.memo("help.insertParagraph",this.lang.help.insertParagraph),this.context.memo("help.insertOrderedList",this.lang.help.insertOrderedList),this.context.memo("help.insertUnorderedList",this.lang.help.insertUnorderedList),this.context.memo("help.indent",this.lang.help.indent),this.context.memo("help.outdent",this.lang.help.outdent),this.context.memo("help.formatPara",this.lang.help.formatPara),this.context.memo("help.insertHorizontalRule",this.lang.help.insertHorizontalRule),this.context.memo("help.fontName",this.lang.help.fontName);const e=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor"];for(let o=0,n=e.length;o<n;o++)this[e[o]]=(s=>a=>{this.beforeCommand(),document.execCommand(s,!1,a),this.afterCommand(!0)})(e[o]),this.context.memo("help."+e[o],this.lang.help[e[o]]);this.fontName=this.wrapCommand(o=>this.fontStyling("font-family",S.validFontName(o))),this.fontSize=this.wrapCommand(o=>{const n=this.currentStyle()["font-size-unit"];return this.fontStyling("font-size",o+n)}),this.fontSizeUnit=this.wrapCommand(o=>{const n=this.currentStyle()["font-size"];return this.fontStyling("font-size",n+o)});for(let o=1;o<=6;o++)this["formatH"+o]=(n=>()=>{this.formatBlock("H"+n)})(o),this.context.memo("help.formatH"+o,this.lang.help["formatH"+o]);this.insertParagraph=this.wrapCommand(()=>{this.typing.insertParagraph(this.editable)}),this.insertOrderedList=this.wrapCommand(()=>{this.bullet.insertOrderedList(this.editable)}),this.insertUnorderedList=this.wrapCommand(()=>{this.bullet.insertUnorderedList(this.editable)}),this.indent=this.wrapCommand(()=>{this.bullet.indent(this.editable)}),this.outdent=this.wrapCommand(()=>{this.bullet.outdent(this.editable)}),this.insertNode=this.wrapCommand(o=>{if(this.isLimited($(o).text().length))return;this.getLastRange().insertNode(o),this.setLastRange(k.createFromNodeAfter(o).select())}),this.insertText=this.wrapCommand(o=>{if(this.isLimited(o.length))return;const s=this.getLastRange().insertNode(r.createText(o));this.setLastRange(k.create(s,r.nodeLength(s)).select())}),this.pasteHTML=this.wrapCommand(o=>{if(this.isLimited(o.length))return;o=this.context.invoke("codeview.purify",o);const n=this.getLastRange().pasteHTML(o);this.setLastRange(k.createFromNodeAfter(u.last(n)).select())}),this.formatBlock=this.wrapCommand((o,n)=>{const s=this.options.callbacks.onApplyCustomStyle;s?s.call(this,n,this.context,this.onFormatBlock):this.onFormatBlock(o,n)}),this.insertHorizontalRule=this.wrapCommand(()=>{const o=this.getLastRange().insertNode(r.create("HR"));o.nextSibling&&this.setLastRange(k.create(o.nextSibling,0).normalize().select())}),this.lineHeight=this.wrapCommand(o=>{this.style.stylePara(this.getLastRange(),{lineHeight:o})}),this.createLink=this.wrapCommand(o=>{let n=[],s=o.url;const a=o.text,l=o.isNewWindow,c=this.options.linkAddNoReferrer,h=this.options.linkAddNoOpener;let d=o.range||this.getLastRange();const f=a.length-d.toString().length;if(f>0&&this.isLimited(f))return;const C=d.toString()!==a;typeof s=="string"&&(s=s.trim()),this.options.onCreateLink?s=this.options.onCreateLink(s):s=this.checkLinkUrl(s);let b=[];if(C){d=d.deleteContents();const T=d.insertNode($("<A></A>").text(a)[0]);b.push(T)}else b=this.style.styleNodes(d,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});$.each(b,(T,A)=>{$(A).attr("href",s),l?($(A).attr("target","_blank"),c&&n.push("noreferrer"),h&&n.push("noopener"),n.length&&$(A).attr("rel",n.join(" "))):$(A).removeAttr("target")}),this.setLastRange(this.createRangeFromList(b).select())}),this.color=this.wrapCommand(o=>{const n=o.foreColor,s=o.backColor;n&&document.execCommand("foreColor",!1,n),s&&document.execCommand("backColor",!1,s)}),this.foreColor=this.wrapCommand(o=>{document.execCommand("foreColor",!1,o)}),this.insertTable=this.wrapCommand(o=>{const n=o.split("x");this.getLastRange().deleteContents().insertNode(this.table.createTable(n[0],n[1],this.options))}),this.removeMedia=this.wrapCommand(()=>{let o=$(this.restoreTarget()).parent();o.closest("figure").length?o.closest("figure").remove():o=$(this.restoreTarget()).detach(),this.setLastRange(k.createFromSelection(o).select()),this.context.triggerEvent("media.delete",o,this.$editable)}),this.floatMe=this.wrapCommand(o=>{const n=$(this.restoreTarget());n.toggleClass("note-float-left",o==="left"),n.toggleClass("note-float-right",o==="right"),n.css("float",o==="none"?"":o)}),this.resize=this.wrapCommand(o=>{const n=$(this.restoreTarget());o=parseFloat(o),o===0?n.css("width",""):n.css({width:o*100+"%",height:""})})}initialize(){this.$editable.on("keydown",t=>{if(t.keyCode===w.code.ENTER&&this.context.triggerEvent("enter",t),this.context.triggerEvent("keydown",t),this.snapshot=this.history.makeSnapshot(),this.hasKeyShortCut=!1,t.isDefaultPrevented()||(this.options.shortcuts?this.hasKeyShortCut=this.handleKeyMap(t):this.preventDefaultEditableShortCuts(t)),this.isLimited(1,t)){const e=this.getLastRange();if(e.eo-e.so===0)return!1}this.setLastRange(),this.options.recordEveryKeystroke&&this.hasKeyShortCut===!1&&this.history.recordUndo()}).on("keyup",t=>{this.setLastRange(),this.context.triggerEvent("keyup",t)}).on("focus",t=>{this.setLastRange(),this.context.triggerEvent("focus",t)}).on("blur",t=>{this.context.triggerEvent("blur",t)}).on("mousedown",t=>{this.context.triggerEvent("mousedown",t)}).on("mouseup",t=>{this.setLastRange(),this.history.recordUndo(),this.context.triggerEvent("mouseup",t)}).on("scroll",t=>{this.context.triggerEvent("scroll",t)}).on("paste",t=>{this.setLastRange(),this.context.triggerEvent("paste",t)}).on("copy",t=>{this.context.triggerEvent("copy",t)}).on("input",()=>{this.isLimited(0)&&this.snapshot&&this.history.applySnapshot(this.snapshot)}),this.$editable.attr("spellcheck",this.options.spellCheck),this.$editable.attr("autocorrect",this.options.spellCheck),this.options.disableGrammar&&this.$editable.attr("data-gramm",!1),this.$editable.html(r.html(this.$note)||r.emptyPara),this.$editable.on(S.inputEventName,v.debounce(()=>{this.context.triggerEvent("change",this.$editable.html(),this.$editable)},10)),this.$editable.on("focusin",t=>{this.context.triggerEvent("focusin",t)}).on("focusout",t=>{this.context.triggerEvent("focusout",t)}),this.options.airMode?this.options.overrideContextMenu&&this.$editor.on("contextmenu",t=>(this.context.triggerEvent("contextmenu",t),!1)):(this.options.width&&this.$editor.outerWidth(this.options.width),this.options.height&&this.$editable.outerHeight(this.options.height),this.options.maxHeight&&this.$editable.css("max-height",this.options.maxHeight),this.options.minHeight&&this.$editable.css("min-height",this.options.minHeight)),this.history.recordUndo(),this.setLastRange()}destroy(){this.$editable.off()}handleKeyMap(t){const e=this.options.keyMap[S.isMac?"mac":"pc"],o=[];t.metaKey&&o.push("CMD"),t.ctrlKey&&!t.altKey&&o.push("CTRL"),t.shiftKey&&o.push("SHIFT");const n=w.nameFromCode[t.keyCode];n&&o.push(n);const s=e[o.join("+")];if(n==="TAB"&&!this.options.tabDisable)this.afterCommand();else if(s){if(this.context.invoke(s)!==!1)return t.preventDefault(),!0}else w.isEdit(t.keyCode)&&(w.isRemove(t.keyCode)&&this.context.invoke("removed"),this.afterCommand());return!1}preventDefaultEditableShortCuts(t){(t.ctrlKey||t.metaKey)&&u.contains([66,73,85],t.keyCode)&&t.preventDefault()}isLimited(t,e){return t=t||0,typeof e<"u"&&(w.isMove(e.keyCode)||w.isNavigation(e.keyCode)||e.ctrlKey||e.metaKey||u.contains([w.code.BACKSPACE,w.code.DELETE],e.keyCode))?!1:this.options.maxTextLength>0&&this.$editable.text().length+t>this.options.maxTextLength}checkLinkUrl(t){return Po.test(t)?"mailto://"+t:Lo.test(t)?"tel://"+t:Fo.test(t)?t:"http://"+t}createRange(){return this.focus(),this.setLastRange(),this.getLastRange()}createRangeFromList(t){const o=k.createFromNodeBefore(u.head(t)).getStartPoint(),s=k.createFromNodeAfter(u.last(t)).getEndPoint();return k.create(o.node,o.offset,s.node,s.offset)}setLastRange(t){t?this.lastRange=t:(this.lastRange=k.create(this.editable),$(this.lastRange.sc).closest(".note-editable").length===0&&(this.lastRange=k.createFromBodyElement(this.editable)))}getLastRange(){return this.lastRange||this.setLastRange(),this.lastRange}saveRange(t){t&&this.getLastRange().collapse().select()}restoreRange(){this.lastRange&&(this.lastRange.select(),this.focus())}saveTarget(t){this.$editable.data("target",t)}clearTarget(){this.$editable.removeData("target")}restoreTarget(){return this.$editable.data("target")}currentStyle(){let t=k.create();return t&&(t=t.normalize()),t?this.style.current(t):this.style.fromNode(this.$editable)}styleFromNode(t){return this.style.fromNode(t)}undo(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.undo(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}commit(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.commit(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}redo(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.redo(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}beforeCommand(){this.context.triggerEvent("before.command",this.$editable.html()),document.execCommand("styleWithCSS",!1,this.options.styleWithCSS),this.focus()}afterCommand(t){this.normalizeContent(),this.history.recordUndo(),t||this.context.triggerEvent("change",this.$editable.html(),this.$editable)}tab(){const t=this.getLastRange();if(t.isCollapsed()&&t.isOnCell())this.table.tab(t);else{if(this.options.tabSize===0)return!1;this.isLimited(this.options.tabSize)||(this.beforeCommand(),this.typing.insertTab(t,this.options.tabSize),this.afterCommand())}}untab(){const t=this.getLastRange();if(t.isCollapsed()&&t.isOnCell())this.table.tab(t,!0);else if(this.options.tabSize===0)return!1}wrapCommand(t){return function(){this.beforeCommand(),t.apply(this,arguments),this.afterCommand()}}removed(t,e,o){t=k.create(),t.isCollapsed()&&t.isOnCell()&&(e=t.ec,(o=e.tagName)&&e.childElementCount===1&&e.childNodes[0].tagName==="BR"&&(o==="P"?e.remove():["TH","TD"].indexOf(o)>=0&&e.firstChild.remove()))}insertImage(t,e){return To(t).then(o=>{this.beforeCommand(),typeof e=="function"?e(o):(typeof e=="string"&&o.attr("data-filename",e),o.css("width",Math.min(this.$editable.width(),o.width()))),o.show(),this.getLastRange().insertNode(o[0]),this.setLastRange(k.createFromNodeAfter(o[0]).select()),this.afterCommand()}).fail(o=>{this.context.triggerEvent("image.upload.error",o)})}insertImagesAsDataURL(t){$.each(t,(e,o)=>{const n=o.name;this.options.maximumImageFileSize&&this.options.maximumImageFileSize<o.size?this.context.triggerEvent("image.upload.error",this.lang.image.maximumFileSizeError):So(o).then(s=>this.insertImage(s,n)).fail(()=>{this.context.triggerEvent("image.upload.error")})})}insertImagesOrCallback(t){this.options.callbacks.onImageUpload?this.context.triggerEvent("image.upload",t):this.insertImagesAsDataURL(t)}getSelectedText(){let t=this.getLastRange();return t.isOnAnchor()&&(t=k.createFromNode(r.ancestor(t.sc,r.isAnchor))),t.toString()}onFormatBlock(t,e){if(document.execCommand("FormatBlock",!1,S.isMSIE?"<"+t+">":t),e&&e.length&&(e[0].tagName.toUpperCase()!==t.toUpperCase()&&(e=e.find(t)),e&&e.length)){const o=this.createRange(),n=$([o.sc,o.ec]).closest(t);n.removeClass();const s=e[0].className||"";s&&n.addClass(s)}}formatPara(){this.formatBlock("P")}fontStyling(t,e){const o=this.getLastRange();if(o!==""){const n=this.style.styleNodes(o);if(this.$editor.find(".note-status-output").html(""),$(n).css(t,e),o.isCollapsed()){const s=u.head(n);s&&!r.nodeLength(s)&&(s.innerHTML=r.ZERO_WIDTH_NBSP_CHAR,k.createFromNode(s.firstChild).select(),this.setLastRange(),this.$editable.data(Ao,s))}else o.select()}else{const n=$.now();this.$editor.find(".note-status-output").html('<div id="note-status-output-'+n+'" class="alert alert-info">'+this.lang.output.noSelection+"</div>"),setTimeout(function(){$("#note-status-output-"+n).remove()},5e3)}}unlink(){let t=this.getLastRange();if(t.isOnAnchor()){const e=r.ancestor(t.sc,r.isAnchor);t=k.createFromNode(e),t.select(),this.setLastRange(),this.beforeCommand(),document.execCommand("unlink"),this.afterCommand()}}getLinkInfo(){this.hasFocus()||this.focus();const t=this.getLastRange().expand(r.isAnchor),e=$(u.head(t.nodes(r.isAnchor))),o={range:t,text:t.toString(),url:e.length?e.attr("href"):""};return e.length&&(o.isNewWindow=e.attr("target")==="_blank"),o}addRow(t){const e=this.getLastRange(this.$editable);e.isCollapsed()&&e.isOnCell()&&(this.beforeCommand(),this.table.addRow(e,t),this.afterCommand())}addCol(t){const e=this.getLastRange(this.$editable);e.isCollapsed()&&e.isOnCell()&&(this.beforeCommand(),this.table.addCol(e,t),this.afterCommand())}deleteRow(){const t=this.getLastRange(this.$editable);t.isCollapsed()&&t.isOnCell()&&(this.beforeCommand(),this.table.deleteRow(t),this.afterCommand())}deleteCol(){const t=this.getLastRange(this.$editable);t.isCollapsed()&&t.isOnCell()&&(this.beforeCommand(),this.table.deleteCol(t),this.afterCommand())}deleteTable(){const t=this.getLastRange(this.$editable);t.isCollapsed()&&t.isOnCell()&&(this.beforeCommand(),this.table.deleteTable(t),this.afterCommand())}resizeTo(t,e,o){let n;if(o){const s=t.y/t.x,a=e.data("ratio");n={width:a>s?t.x:t.y/a,height:a>s?t.x*a:t.y}}else n={width:t.x,height:t.y};e.css(n)}hasFocus(){return this.$editable.is(":focus")}focus(){this.hasFocus()||this.$editable.trigger("focus")}isEmpty(){return r.isEmpty(this.$editable[0])||r.emptyPara===this.$editable.html()}empty(){this.context.invoke("code",r.emptyPara)}normalizeContent(){this.$editable[0].normalize()}}class Do{constructor(t){this.context=t,this.options=t.options,this.$editable=t.layoutInfo.editable}initialize(){this.$editable.on("paste",this.pasteByEvent.bind(this))}pasteByEvent(t){if(this.context.isDisabled())return;const e=t.originalEvent.clipboardData;if(e&&e.items&&e.items.length){const o=e.files,n=e.getData("Text");o.length>0&&this.options.allowClipboardImagePasting&&(this.context.invoke("editor.insertImagesOrCallback",o),t.preventDefault()),n.length>0&&this.context.invoke("editor.isLimited",n.length)&&t.preventDefault()}else if(window.clipboardData){let o=window.clipboardData.getData("text");this.context.invoke("editor.isLimited",o.length)&&t.preventDefault()}setTimeout(()=>{this.context.invoke("editor.afterCommand")},10)}}class Mo{constructor(t){this.context=t,this.$eventListener=$(document),this.$editor=t.layoutInfo.editor,this.$editable=t.layoutInfo.editable,this.options=t.options,this.lang=this.options.langInfo,this.documentEventHandlers={},this.$dropzone=$(['<div class="note-dropzone">','<div class="note-dropzone-message"></div>',"</div>"].join("")).prependTo(this.$editor)}initialize(){this.options.disableDragAndDrop?(this.documentEventHandlers.onDrop=t=>{t.preventDefault()},this.$eventListener=this.$dropzone,this.$eventListener.on("drop",this.documentEventHandlers.onDrop)):this.attachDragAndDropEvent()}attachDragAndDropEvent(){let t=$();const e=this.$dropzone.find(".note-dropzone-message");this.documentEventHandlers.onDragenter=o=>{const n=this.context.invoke("codeview.isActivated"),s=this.$editor.width()>0&&this.$editor.height()>0;!n&&!t.length&&s&&(this.$editor.addClass("dragover"),this.$dropzone.width(this.$editor.width()),this.$dropzone.height(this.$editor.height()),e.text(this.lang.image.dragImageHere)),t=t.add(o.target)},this.documentEventHandlers.onDragleave=o=>{t=t.not(o.target),(!t.length||o.target.nodeName==="BODY")&&(t=$(),this.$editor.removeClass("dragover"))},this.documentEventHandlers.onDrop=()=>{t=$(),this.$editor.removeClass("dragover")},this.$eventListener.on("dragenter",this.documentEventHandlers.onDragenter).on("dragleave",this.documentEventHandlers.onDragleave).on("drop",this.documentEventHandlers.onDrop),this.$dropzone.on("dragenter",()=>{this.$dropzone.addClass("hover"),e.text(this.lang.image.dropImage)}).on("dragleave",()=>{this.$dropzone.removeClass("hover"),e.text(this.lang.image.dragImageHere)}),this.$dropzone.on("drop",o=>{const n=o.originalEvent.dataTransfer;o.preventDefault(),n&&n.files&&n.files.length?(this.$editable.trigger("focus"),this.context.invoke("editor.insertImagesOrCallback",n.files)):$.each(n.types,(s,a)=>{if(a.toLowerCase().indexOf("_moz_")>-1)return;const l=n.getData(a);a.toLowerCase().indexOf("text")>-1?this.context.invoke("editor.pasteHTML",l):$(l).each((c,h)=>{this.context.invoke("editor.insertNode",h)})})}).on("dragover",!1)}destroy(){Object.keys(this.documentEventHandlers).forEach(t=>{this.$eventListener.off(t.slice(2).toLowerCase(),this.documentEventHandlers[t])}),this.documentEventHandlers={}}}class zo{constructor(t){this.context=t,this.$editor=t.layoutInfo.editor,this.$editable=t.layoutInfo.editable,this.$codable=t.layoutInfo.codable,this.options=t.options,this.CodeMirrorConstructor=window.CodeMirror,this.options.codemirror.CodeMirrorConstructor&&(this.CodeMirrorConstructor=this.options.codemirror.CodeMirrorConstructor)}sync(t){const e=this.isActivated(),o=this.CodeMirrorConstructor;e&&(t?o?this.$codable.data("cmEditor").getDoc().setValue(t):this.$codable.val(t):o&&this.$codable.data("cmEditor").save())}initialize(){this.$codable.on("keyup",t=>{t.keyCode===w.code.ESCAPE&&this.deactivate()})}isActivated(){return this.$editor.hasClass("codeview")}toggle(){this.isActivated()?this.deactivate():this.activate(),this.context.triggerEvent("codeview.toggled")}purify(t){if(this.options.codeviewFilter&&(t=t.replace(this.options.codeviewFilterRegex,""),this.options.codeviewIframeFilter)){const e=this.options.codeviewIframeWhitelistSrc.concat(this.options.codeviewIframeWhitelistSrcBase);t=t.replace(/(<iframe.*?>.*?(?:<\/iframe>)?)/gi,function(o){if(/<.+src(?==?('|"|\s)?)[\s\S]+src(?=('|"|\s)?)[^>]*?>/i.test(o))return"";for(const n of e)if(new RegExp('src="(https?:)?//'+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+'/(.+)"').test(o))return o;return""})}return t}activate(){const t=this.CodeMirrorConstructor;if(this.$codable.val(r.html(this.$editable,this.options.prettifyHtml)),this.$codable.height(this.$editable.height()),this.context.invoke("toolbar.updateCodeview",!0),this.context.invoke("airPopover.updateCodeview",!0),this.$editor.addClass("codeview"),this.$codable.trigger("focus"),t){const e=t.fromTextArea(this.$codable[0],this.options.codemirror);if(this.options.codemirror.tern){const o=new t.TernServer(this.options.codemirror.tern);e.ternServer=o,e.on("cursorActivity",n=>{o.updateArgHints(n)})}e.on("blur",o=>{this.context.triggerEvent("blur.codeview",e.getValue(),o)}),e.on("change",()=>{this.context.triggerEvent("change.codeview",e.getValue(),e)}),e.setSize(null,this.$editable.outerHeight()),this.$codable.data("cmEditor",e)}else this.$codable.on("blur",e=>{this.context.triggerEvent("blur.codeview",this.$codable.val(),e)}),this.$codable.on("input",()=>{this.context.triggerEvent("change.codeview",this.$codable.val(),this.$codable)})}deactivate(){if(this.CodeMirrorConstructor){const n=this.$codable.data("cmEditor");this.$codable.val(n.getValue()),n.toTextArea()}const e=this.purify(r.value(this.$codable,this.options.prettifyHtml)||r.emptyPara),o=this.$editable.html()!==e;this.$editable.html(e),this.$editable.height(this.options.height?this.$codable.height():"auto"),this.$editor.removeClass("codeview"),o&&this.context.triggerEvent("change",this.$editable.html(),this.$editable),this.$editable.trigger("focus"),this.context.invoke("toolbar.updateCodeview",!1),this.context.invoke("airPopover.updateCodeview",!1)}destroy(){this.isActivated()&&this.deactivate()}}const Jt=24;class Bo{constructor(t){this.$document=$(document),this.$statusbar=t.layoutInfo.statusbar,this.$editable=t.layoutInfo.editable,this.$codable=t.layoutInfo.codable,this.options=t.options}initialize(){if(this.options.airMode||this.options.disableResizeEditor){this.destroy();return}this.$statusbar.on("mousedown touchstart",t=>{t.preventDefault(),t.stopPropagation();const e=this.$editable.offset().top-this.$document.scrollTop(),o=this.$codable.offset().top-this.$document.scrollTop(),n=s=>{let a=s.type=="mousemove"?s:s.originalEvent.touches[0],l=a.clientY-(e+Jt),c=a.clientY-(o+Jt);l=this.options.minheight>0?Math.max(l,this.options.minheight):l,l=this.options.maxHeight>0?Math.min(l,this.options.maxHeight):l,c=this.options.minheight>0?Math.max(c,this.options.minheight):c,c=this.options.maxHeight>0?Math.min(c,this.options.maxHeight):c,this.$editable.height(l),this.$codable.height(c)};this.$document.on("mousemove touchmove",n).one("mouseup touchend",()=>{this.$document.off("mousemove touchmove",n)})})}destroy(){this.$statusbar.off(),this.$statusbar.addClass("locked")}}class Oo{constructor(t){this.context=t,this.$editor=t.layoutInfo.editor,this.$toolbar=t.layoutInfo.toolbar,this.$editable=t.layoutInfo.editable,this.$codable=t.layoutInfo.codable,this.$window=$(window),this.$scrollbar=$("html, body"),this.scrollbarClassName="note-fullscreen-body",this.onResize=()=>{this.resizeTo({h:this.$window.height()-this.$toolbar.outerHeight()})}}resizeTo(t){this.$editable.css("height",t.h),this.$codable.css("height",t.h),this.$codable.data("cmeditor")&&this.$codable.data("cmeditor").setsize(null,t.h)}toggle(){this.$editor.toggleClass("fullscreen");const t=this.isFullscreen();this.$scrollbar.toggleClass(this.scrollbarClassName,t),t?(this.$editable.data("orgHeight",this.$editable.css("height")),this.$editable.data("orgMaxHeight",this.$editable.css("maxHeight")),this.$editable.css("maxHeight",""),this.$window.on("resize",this.onResize).trigger("resize")):(this.$window.off("resize",this.onResize),this.resizeTo({h:this.$editable.data("orgHeight")}),this.$editable.css("maxHeight",this.$editable.css("orgMaxHeight"))),this.context.invoke("toolbar.updateFullscreen",t)}isFullscreen(){return this.$editor.hasClass("fullscreen")}destroy(){this.$scrollbar.removeClass(this.scrollbarClassName)}}class Uo{constructor(t){this.context=t,this.$document=$(document),this.$editingArea=t.layoutInfo.editingArea,this.options=t.options,this.lang=this.options.langInfo,this.events={"summernote.mousedown":(e,o)=>{this.update(o.target,o)&&o.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":()=>{this.update()},"summernote.disable summernote.blur":()=>{this.hide()},"summernote.codeview.toggled":()=>{this.update()}}}initialize(){this.$handle=$(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',this.options.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',this.options.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(this.$editingArea),this.$handle.on("mousedown",t=>{if(r.isControlSizing(t.target)){t.preventDefault(),t.stopPropagation();const e=this.$handle.find(".note-control-selection").data("target"),o=e.offset(),n=this.$document.scrollTop(),s=a=>{this.context.invoke("editor.resizeTo",{x:a.clientX-o.left,y:a.clientY-(o.top-n)},e,!a.shiftKey),this.update(e[0],a)};this.$document.on("mousemove",s).one("mouseup",a=>{a.preventDefault(),this.$document.off("mousemove",s),this.context.invoke("editor.afterCommand")}),e.data("ratio")||e.data("ratio",e.height()/e.width())}}),this.$handle.on("wheel",t=>{t.preventDefault(),this.update()})}destroy(){this.$handle.remove()}update(t,e){if(this.context.isDisabled())return!1;const o=r.isImg(t),n=this.$handle.find(".note-control-selection");if(this.context.invoke("imagePopover.update",t,e),o){const s=$(t),a=this.$editingArea[0].getBoundingClientRect(),l=t.getBoundingClientRect();n.css({display:"block",left:l.left-a.left,top:l.top-a.top,width:l.width,height:l.height}).data("target",s);const c=new Image;c.src=s.attr("src");const h=l.width+"x"+l.height+" ("+this.lang.image.original+": "+c.width+"x"+c.height+")";n.find(".note-control-selection-info").text(h),this.context.invoke("editor.saveTarget",t)}else this.hide();return o}hide(){this.context.invoke("editor.clearTarget"),this.$handle.children().hide()}}const jo="http://",Wo=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/]{2}|tel:|mailto:[A-Z0-9._%+-]+@|xmpp:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;class Ko{constructor(t){this.context=t,this.options=t.options,this.$editable=t.layoutInfo.editable,this.events={"summernote.keyup":(e,o)=>{o.isDefaultPrevented()||this.handleKeyup(o)},"summernote.keydown":(e,o)=>{this.handleKeydown(o)}}}initialize(){this.lastWordRange=null}destroy(){this.lastWordRange=null}replace(){if(!this.lastWordRange)return;const t=this.lastWordRange.toString(),e=t.match(Wo);if(e&&(e[1]||e[2])){const o=e[1]?t:jo+t,n=this.options.showDomainOnlyForAutolink?t.replace(/^(?:https?:\/\/)?(?:tel?:?)?(?:mailto?:?)?(?:xmpp?:?)?(?:www\.)?/i,"").split("/")[0]:t,s=$("<a></a>").html(n).attr("href",o)[0];this.context.options.linkTargetBlank&&$(s).attr("target","_blank"),this.lastWordRange.insertNode(s),this.lastWordRange=null,this.context.invoke("editor.focus"),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}}handleKeydown(t){if(u.contains([w.code.ENTER,w.code.SPACE],t.keyCode)){const e=this.context.invoke("editor.createRange").getWordRange();this.lastWordRange=e}}handleKeyup(t){(w.code.SPACE===t.keyCode||w.code.ENTER===t.keyCode&&!t.shiftKey)&&this.replace()}}class Vo{constructor(t){this.$note=t.layoutInfo.note,this.events={"summernote.change":()=>{this.$note.val(t.invoke("code"))}}}shouldInitialize(){return r.isTextarea(this.$note[0])}}class qo{constructor(t){this.context=t,this.options=t.options.replace||{},this.keys=[w.code.ENTER,w.code.SPACE,w.code.PERIOD,w.code.COMMA,w.code.SEMICOLON,w.code.SLASH],this.previousKeydownCode=null,this.events={"summernote.keyup":(e,o)=>{o.isDefaultPrevented()||this.handleKeyup(o)},"summernote.keydown":(e,o)=>{this.handleKeydown(o)}}}shouldInitialize(){return!!this.options.match}initialize(){this.lastWord=null}destroy(){this.lastWord=null}replace(){if(!this.lastWord)return;const t=this,e=this.lastWord.toString();this.options.match(e,function(o){if(o){let n="";if(typeof o=="string"?n=r.createText(o):o instanceof jQuery?n=o[0]:o instanceof Node&&(n=o),!n)return;t.lastWord.insertNode(n),t.lastWord=null,t.context.invoke("editor.focus")}})}handleKeydown(t){if(this.previousKeydownCode&&u.contains(this.keys,this.previousKeydownCode)){this.previousKeydownCode=t.keyCode;return}if(u.contains(this.keys,t.keyCode)){const e=this.context.invoke("editor.createRange").getWordRange();this.lastWord=e}this.previousKeydownCode=t.keyCode}handleKeyup(t){u.contains(this.keys,t.keyCode)&&this.replace()}}class _o{constructor(t){this.context=t,this.$editingArea=t.layoutInfo.editingArea,this.options=t.options,this.options.inheritPlaceholder===!0&&(this.options.placeholder=this.context.$note.attr("placeholder")||this.options.placeholder),this.events={"summernote.init summernote.change":()=>{this.update()},"summernote.codeview.toggled":()=>{this.update()}}}shouldInitialize(){return!!this.options.placeholder}initialize(){this.$placeholder=$('<div class="note-placeholder"></div>'),this.$placeholder.on("click",()=>{this.context.invoke("focus")}).html(this.options.placeholder).prependTo(this.$editingArea),this.update()}destroy(){this.$placeholder.remove()}update(){const t=!this.context.invoke("codeview.isActivated")&&this.context.invoke("editor.isEmpty");this.$placeholder.toggle(t)}}class Go{constructor(t){this.ui=$.summernote.ui,this.context=t,this.$toolbar=t.layoutInfo.toolbar,this.options=t.options,this.lang=this.options.langInfo,this.invertedKeyMap=v.invertObject(this.options.keyMap[S.isMac?"mac":"pc"])}representShortcut(t){let e=this.invertedKeyMap[t];return!this.options.shortcuts||!e?"":(S.isMac&&(e=e.replace("CMD","â").replace("SHIFT","â§")),e=e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")," ("+e+")")}button(t){return!this.options.tooltip&&t.tooltip&&delete t.tooltip,t.container=this.options.container,this.ui.button(t)}initialize(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.addTablePopoverButtons(),this.fontInstalledMap={}}destroy(){delete this.fontInstalledMap}isFontInstalled(t){return Object.prototype.hasOwnProperty.call(this.fontInstalledMap,t)||(this.fontInstalledMap[t]=S.isFontInstalled(t)||u.contains(this.options.fontNamesIgnoreCheck,t)),this.fontInstalledMap[t]}isFontDeservedToAdd(t){return t=t.toLowerCase(),t!==""&&this.isFontInstalled(t)&&S.genericFontFamilies.indexOf(t)===-1}colorPalette(t,e,o,n){return this.ui.buttonGroup({className:"note-color "+t,children:[this.button({className:"note-current-color-button",contents:this.ui.icon(this.options.icons.font+" note-recent-color"),tooltip:e,click:s=>{const a=$(s.currentTarget);o&&n?this.context.invoke("editor.color",{backColor:a.attr("data-backColor"),foreColor:a.attr("data-foreColor")}):o?this.context.invoke("editor.color",{backColor:a.attr("data-backColor")}):n&&this.context.invoke("editor.color",{foreColor:a.attr("data-foreColor")})},callback:s=>{const a=s.find(".note-recent-color");o&&(a.css("background-color",this.options.colorButton.backColor),s.attr("data-backColor",this.options.colorButton.backColor)),n?(a.css("color",this.options.colorButton.foreColor),s.attr("data-foreColor",this.options.colorButton.foreColor)):a.css("color","transparent")}}),this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents("",this.options),tooltip:this.lang.color.more,data:{toggle:"dropdown"}}),this.ui.dropdown({items:(o?['<div class="note-palette">','<div class="note-palette-title">'+this.lang.color.background+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light btn-default" data-event="backColor" data-value="transparent">',this.lang.color.transparent,"</button>","</div>",'<div class="note-holder" data-event="backColor"><!-- back colors --></div>',"<div>",'<button type="button" class="note-color-select btn btn-light btn-default" data-event="openPalette" data-value="backColorPicker-'+this.options.id+'">',this.lang.color.cpSelect,"</button>",'<input type="color" id="backColorPicker-'+this.options.id+'" class="note-btn note-color-select-btn" value="'+this.options.colorButton.backColor+'" data-event="backColorPalette-'+this.options.id+'">',"</div>",'<div class="note-holder-custom" id="backColorPalette-'+this.options.id+'" data-event="backColor"></div>',"</div>"].join(""):"")+(n?['<div class="note-palette">','<div class="note-palette-title">'+this.lang.color.foreground+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light btn-default" data-event="removeFormat" data-value="foreColor">',this.lang.color.resetToDefault,"</button>","</div>",'<div class="note-holder" data-event="foreColor"><!-- fore colors --></div>',"<div>",'<button type="button" class="note-color-select btn btn-light btn-default" data-event="openPalette" data-value="foreColorPicker-'+this.options.id+'">',this.lang.color.cpSelect,"</button>",'<input type="color" id="foreColorPicker-'+this.options.id+'" class="note-btn note-color-select-btn" value="'+this.options.colorButton.foreColor+'" data-event="foreColorPalette-'+this.options.id+'">',"</div>",'<div class="note-holder-custom" id="foreColorPalette-'+this.options.id+'" data-event="foreColor"></div>',"</div>"].join(""):""),callback:s=>{s.find(".note-holder").each((l,c)=>{const h=$(c);h.append(this.ui.palette({colors:this.options.colors,colorsName:this.options.colorsName,eventName:h.data("event"),container:this.options.container,tooltip:this.options.tooltip}).render())});var a=[["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]];s.find(".note-holder-custom").each((l,c)=>{const h=$(c);h.append(this.ui.palette({colors:a,colorsName:a,eventName:h.data("event"),container:this.options.container,tooltip:this.options.tooltip}).render())}),s.find("input[type=color]").each((l,c)=>{$(c).on("change",function(){const h=s.find("#"+$(this).data("event")).find(".note-color-btn").first(),d=this.value.toUpperCase();h.css("background-color",d).attr("aria-label",d).attr("data-value",d).attr("data-original-title",d),h.trigger("click")})})},click:s=>{s.stopPropagation();const a=$("."+t).find(".note-dropdown-menu"),l=$(s.target),c=l.data("event"),h=l.attr("data-value");if(c==="openPalette"){const d=a.find("#"+h),f=$(a.find("#"+d.data("event")).find(".note-color-row")[0]),C=f.find(".note-color-btn").last().detach(),b=d.val();C.css("background-color",b).attr("aria-label",b).attr("data-value",b).attr("data-original-title",b),f.prepend(C),d.trigger("click")}else{if(u.contains(["backColor","foreColor"],c)){const d=c==="backColor"?"background-color":"color",f=l.closest(".note-color").find(".note-recent-color"),C=l.closest(".note-color").find(".note-current-color-button");f.css(d,h),C.attr("data-"+c,h)}this.context.invoke("editor."+c,h)}}})]}).render()}addToolbarButtons(){this.context.memo("button.style",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents(this.ui.icon(this.options.icons.magic),this.options),tooltip:this.lang.style.style,data:{toggle:"dropdown"}}),this.ui.dropdown({className:"dropdown-style",items:this.options.styleTags,title:this.lang.style.style,template:l=>{typeof l=="string"&&(l={tag:l,title:Object.prototype.hasOwnProperty.call(this.lang.style,l)?this.lang.style[l]:l});const c=l.tag,h=l.title,d=l.style?' style="'+l.style+'" ':"",f=l.className?' class="'+l.className+'"':"";return"<"+c+d+f+">"+h+"</"+c+">"},click:this.context.createInvokeHandler("editor.formatBlock")})]).render());for(let l=0,c=this.options.styleTags.length;l<c;l++){const h=this.options.styleTags[l];this.context.memo("button.style."+h,()=>this.button({className:"note-btn-style-"+h,contents:'<div data-value="'+h+'">'+h.toUpperCase()+"</div>",tooltip:this.lang.style[h],click:this.context.createInvokeHandler("editor.formatBlock")}).render())}this.context.memo("button.bold",()=>this.button({className:"note-btn-bold",contents:this.ui.icon(this.options.icons.bold),tooltip:this.lang.font.bold+this.representShortcut("bold"),click:this.context.createInvokeHandlerAndUpdateState("editor.bold")}).render()),this.context.memo("button.italic",()=>this.button({className:"note-btn-italic",contents:this.ui.icon(this.options.icons.italic),tooltip:this.lang.font.italic+this.representShortcut("italic"),click:this.context.createInvokeHandlerAndUpdateState("editor.italic")}).render()),this.context.memo("button.underline",()=>this.button({className:"note-btn-underline",contents:this.ui.icon(this.options.icons.underline),tooltip:this.lang.font.underline+this.representShortcut("underline"),click:this.context.createInvokeHandlerAndUpdateState("editor.underline")}).render()),this.context.memo("button.clear",()=>this.button({contents:this.ui.icon(this.options.icons.eraser),tooltip:this.lang.font.clear+this.representShortcut("removeFormat"),click:this.context.createInvokeHandler("editor.removeFormat")}).render()),this.context.memo("button.strikethrough",()=>this.button({className:"note-btn-strikethrough",contents:this.ui.icon(this.options.icons.strikethrough),tooltip:this.lang.font.strikethrough+this.representShortcut("strikethrough"),click:this.context.createInvokeHandlerAndUpdateState("editor.strikethrough")}).render()),this.context.memo("button.superscript",()=>this.button({className:"note-btn-superscript",contents:this.ui.icon(this.options.icons.superscript),tooltip:this.lang.font.superscript,click:this.context.createInvokeHandlerAndUpdateState("editor.superscript")}).render()),this.context.memo("button.subscript",()=>this.button({className:"note-btn-subscript",contents:this.ui.icon(this.options.icons.subscript),tooltip:this.lang.font.subscript,click:this.context.createInvokeHandlerAndUpdateState("editor.subscript")}).render()),this.context.memo("button.fontname",()=>{const l=this.context.invoke("editor.currentStyle");return this.options.addDefaultFonts&&$.each(l["font-family"].split(","),(c,h)=>{h=h.trim().replace(/['"]+/g,""),this.isFontDeservedToAdd(h)&&this.options.fontNames.indexOf(h)===-1&&this.options.fontNames.push(h)}),this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents('<span class="note-current-fontname"></span>',this.options),tooltip:this.lang.font.name,data:{toggle:"dropdown"}}),this.ui.dropdownCheck({className:"dropdown-fontname",checkClassName:this.options.icons.menuCheck,items:this.options.fontNames.filter(this.isFontInstalled.bind(this)),title:this.lang.font.name,template:c=>'<span style="font-family: '+S.validFontName(c)+'">'+c+"</span>",click:this.context.createInvokeHandlerAndUpdateState("editor.fontName")})]).render()}),this.context.memo("button.fontsize",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents('<span class="note-current-fontsize"></span>',this.options),tooltip:this.lang.font.size,data:{toggle:"dropdown"}}),this.ui.dropdownCheck({className:"dropdown-fontsize",checkClassName:this.options.icons.menuCheck,items:this.options.fontSizes,title:this.lang.font.size,click:this.context.createInvokeHandlerAndUpdateState("editor.fontSize")})]).render()),this.context.memo("button.fontsizeunit",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents('<span class="note-current-fontsizeunit"></span>',this.options),tooltip:this.lang.font.sizeunit,data:{toggle:"dropdown"}}),this.ui.dropdownCheck({className:"dropdown-fontsizeunit",checkClassName:this.options.icons.menuCheck,items:this.options.fontSizeUnits,title:this.lang.font.sizeunit,click:this.context.createInvokeHandlerAndUpdateState("editor.fontSizeUnit")})]).render()),this.context.memo("button.color",()=>this.colorPalette("note-color-all",this.lang.color.recent,!0,!0)),this.context.memo("button.forecolor",()=>this.colorPalette("note-color-fore",this.lang.color.foreground,!1,!0)),this.context.memo("button.backcolor",()=>this.colorPalette("note-color-back",this.lang.color.background,!0,!1)),this.context.memo("button.ul",()=>this.button({contents:this.ui.icon(this.options.icons.unorderedlist),tooltip:this.lang.lists.unordered+this.representShortcut("insertUnorderedList"),click:this.context.createInvokeHandler("editor.insertUnorderedList")}).render()),this.context.memo("button.ol",()=>this.button({contents:this.ui.icon(this.options.icons.orderedlist),tooltip:this.lang.lists.ordered+this.representShortcut("insertOrderedList"),click:this.context.createInvokeHandler("editor.insertOrderedList")}).render());const t=this.button({contents:this.ui.icon(this.options.icons.alignLeft),tooltip:this.lang.paragraph.left+this.representShortcut("justifyLeft"),click:this.context.createInvokeHandler("editor.justifyLeft")}),e=this.button({contents:this.ui.icon(this.options.icons.alignCenter),tooltip:this.lang.paragraph.center+this.representShortcut("justifyCenter"),click:this.context.createInvokeHandler("editor.justifyCenter")}),o=this.button({contents:this.ui.icon(this.options.icons.alignRight),tooltip:this.lang.paragraph.right+this.representShortcut("justifyRight"),click:this.context.createInvokeHandler("editor.justifyRight")}),n=this.button({contents:this.ui.icon(this.options.icons.alignJustify),tooltip:this.lang.paragraph.justify+this.representShortcut("justifyFull"),click:this.context.createInvokeHandler("editor.justifyFull")}),s=this.button({contents:this.ui.icon(this.options.icons.outdent),tooltip:this.lang.paragraph.outdent+this.representShortcut("outdent"),click:this.context.createInvokeHandler("editor.outdent")}),a=this.button({contents:this.ui.icon(this.options.icons.indent),tooltip:this.lang.paragraph.indent+this.representShortcut("indent"),click:this.context.createInvokeHandler("editor.indent")});this.context.memo("button.justifyLeft",v.invoke(t,"render")),this.context.memo("button.justifyCenter",v.invoke(e,"render")),this.context.memo("button.justifyRight",v.invoke(o,"render")),this.context.memo("button.justifyFull",v.invoke(n,"render")),this.context.memo("button.outdent",v.invoke(s,"render")),this.context.memo("button.indent",v.invoke(a,"render")),this.context.memo("button.paragraph",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents(this.ui.icon(this.options.icons.alignLeft),this.options),tooltip:this.lang.paragraph.paragraph,data:{toggle:"dropdown"}}),this.ui.dropdown([this.ui.buttonGroup({className:"note-align",children:[t,e,o,n]}),this.ui.buttonGroup({className:"note-list",children:[s,a]})])]).render()),this.context.memo("button.height",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents(this.ui.icon(this.options.icons.textHeight),this.options),tooltip:this.lang.font.height,data:{toggle:"dropdown"}}),this.ui.dropdownCheck({items:this.options.lineHeights,checkClassName:this.options.icons.menuCheck,className:"dropdown-line-height",title:this.lang.font.height,click:this.context.createInvokeHandler("editor.lineHeight")})]).render()),this.context.memo("button.table",()=>this.ui.buttonGroup([this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents(this.ui.icon(this.options.icons.table),this.options),tooltip:this.lang.table.table,data:{toggle:"dropdown"}}),this.ui.dropdown({title:this.lang.table.table,className:"note-table",items:['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:l=>{l.find(".note-dimension-picker-mousecatcher").css({width:this.options.insertTableMaxSize.col+"em",height:this.options.insertTableMaxSize.row+"em"}).on("mousedown",this.context.createInvokeHandler("editor.insertTable")).on("mousemove",this.tableMoveHandler.bind(this))}}).render()),this.context.memo("button.link",()=>this.button({contents:this.ui.icon(this.options.icons.link),tooltip:this.lang.link.link+this.representShortcut("linkDialog.show"),click:this.context.createInvokeHandler("linkDialog.show")}).render()),this.context.memo("button.picture",()=>this.button({contents:this.ui.icon(this.options.icons.picture),tooltip:this.lang.image.image,click:this.context.createInvokeHandler("imageDialog.show")}).render()),this.context.memo("button.video",()=>this.button({contents:this.ui.icon(this.options.icons.video),tooltip:this.lang.video.video,click:this.context.createInvokeHandler("videoDialog.show")}).render()),this.context.memo("button.hr",()=>this.button({contents:this.ui.icon(this.options.icons.minus),tooltip:this.lang.hr.insert+this.representShortcut("insertHorizontalRule"),click:this.context.createInvokeHandler("editor.insertHorizontalRule")}).render()),this.context.memo("button.fullscreen",()=>this.button({className:"btn-fullscreen note-codeview-keep",contents:this.ui.icon(this.options.icons.arrowsAlt),tooltip:this.lang.options.fullscreen,click:this.context.createInvokeHandler("fullscreen.toggle")}).render()),this.context.memo("button.codeview",()=>this.button({className:"btn-codeview note-codeview-keep",contents:this.ui.icon(this.options.icons.code),tooltip:this.lang.options.codeview,click:this.context.createInvokeHandler("codeview.toggle")}).render()),this.context.memo("button.redo",()=>this.button({contents:this.ui.icon(this.options.icons.redo),tooltip:this.lang.history.redo+this.representShortcut("redo"),click:this.context.createInvokeHandler("editor.redo")}).render()),this.context.memo("button.undo",()=>this.button({contents:this.ui.icon(this.options.icons.undo),tooltip:this.lang.history.undo+this.representShortcut("undo"),click:this.context.createInvokeHandler("editor.undo")}).render()),this.context.memo("button.help",()=>this.button({contents:this.ui.icon(this.options.icons.question),tooltip:this.lang.options.help,click:this.context.createInvokeHandler("helpDialog.show")}).render())}addImagePopoverButtons(){this.context.memo("button.resizeFull",()=>this.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:this.lang.image.resizeFull,click:this.context.createInvokeHandler("editor.resize","1")}).render()),this.context.memo("button.resizeHalf",()=>this.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:this.lang.image.resizeHalf,click:this.context.createInvokeHandler("editor.resize","0.5")}).render()),this.context.memo("button.resizeQuarter",()=>this.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:this.lang.image.resizeQuarter,click:this.context.createInvokeHandler("editor.resize","0.25")}).render()),this.context.memo("button.resizeNone",()=>this.button({contents:this.ui.icon(this.options.icons.rollback),tooltip:this.lang.image.resizeNone,click:this.context.createInvokeHandler("editor.resize","0")}).render()),this.context.memo("button.floatLeft",()=>this.button({contents:this.ui.icon(this.options.icons.floatLeft),tooltip:this.lang.image.floatLeft,click:this.context.createInvokeHandler("editor.floatMe","left")}).render()),this.context.memo("button.floatRight",()=>this.button({contents:this.ui.icon(this.options.icons.floatRight),tooltip:this.lang.image.floatRight,click:this.context.createInvokeHandler("editor.floatMe","right")}).render()),this.context.memo("button.floatNone",()=>this.button({contents:this.ui.icon(this.options.icons.rollback),tooltip:this.lang.image.floatNone,click:this.context.createInvokeHandler("editor.floatMe","none")}).render()),this.context.memo("button.removeMedia",()=>this.button({contents:this.ui.icon(this.options.icons.trash),tooltip:this.lang.image.remove,click:this.context.createInvokeHandler("editor.removeMedia")}).render())}addLinkPopoverButtons(){this.context.memo("button.linkDialogShow",()=>this.button({contents:this.ui.icon(this.options.icons.link),tooltip:this.lang.link.edit,click:this.context.createInvokeHandler("linkDialog.show")}).render()),this.context.memo("button.unlink",()=>this.button({contents:this.ui.icon(this.options.icons.unlink),tooltip:this.lang.link.unlink,click:this.context.createInvokeHandler("editor.unlink")}).render())}addTablePopoverButtons(){this.context.memo("button.addRowUp",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.rowAbove),tooltip:this.lang.table.addRowAbove,click:this.context.createInvokeHandler("editor.addRow","top")}).render()),this.context.memo("button.addRowDown",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.rowBelow),tooltip:this.lang.table.addRowBelow,click:this.context.createInvokeHandler("editor.addRow","bottom")}).render()),this.context.memo("button.addColLeft",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.colBefore),tooltip:this.lang.table.addColLeft,click:this.context.createInvokeHandler("editor.addCol","left")}).render()),this.context.memo("button.addColRight",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.colAfter),tooltip:this.lang.table.addColRight,click:this.context.createInvokeHandler("editor.addCol","right")}).render()),this.context.memo("button.deleteRow",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.rowRemove),tooltip:this.lang.table.delRow,click:this.context.createInvokeHandler("editor.deleteRow")}).render()),this.context.memo("button.deleteCol",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.colRemove),tooltip:this.lang.table.delCol,click:this.context.createInvokeHandler("editor.deleteCol")}).render()),this.context.memo("button.deleteTable",()=>this.button({className:"btn-md",contents:this.ui.icon(this.options.icons.trash),tooltip:this.lang.table.delTable,click:this.context.createInvokeHandler("editor.deleteTable")}).render())}build(t,e){for(let o=0,n=e.length;o<n;o++){const s=e[o],a=Array.isArray(s)?s[0]:s,l=Array.isArray(s)?s.length===1?[s[0]]:s[1]:[s],c=this.ui.buttonGroup({className:"note-"+a}).render();for(let h=0,d=l.length;h<d;h++){const f=this.context.memo("button."+l[h]);f&&c.append(typeof f=="function"?f(this.context):f)}c.appendTo(t)}}updateCurrentStyle(t){const e=t||this.$toolbar,o=this.context.invoke("editor.currentStyle");if(this.updateBtnStates(e,{".note-btn-bold":()=>o["font-bold"]==="bold",".note-btn-italic":()=>o["font-italic"]==="italic",".note-btn-underline":()=>o["font-underline"]==="underline",".note-btn-subscript":()=>o["font-subscript"]==="subscript",".note-btn-superscript":()=>o["font-superscript"]==="superscript",".note-btn-strikethrough":()=>o["font-strikethrough"]==="strikethrough"}),o["font-family"]){const n=o["font-family"].split(",").map(a=>a.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")),s=u.find(n,this.isFontInstalled.bind(this));e.find(".dropdown-fontname a").each((a,l)=>{const c=$(l),h=c.data("value")+""==s+"";c.toggleClass("checked",h)}),e.find(".note-current-fontname").text(s).css("font-family",s)}if(o["font-size"]){const n=o["font-size"];e.find(".dropdown-fontsize a").each((a,l)=>{const c=$(l),h=c.data("value")+""==n+"";c.toggleClass("checked",h)}),e.find(".note-current-fontsize").text(n);const s=o["font-size-unit"];e.find(".dropdown-fontsizeunit a").each((a,l)=>{const c=$(l),h=c.data("value")+""==s+"";c.toggleClass("checked",h)}),e.find(".note-current-fontsizeunit").text(s)}if(o["line-height"]){const n=o["line-height"];e.find(".dropdown-line-height a").each((s,a)=>{const l=$(a),c=$(a).data("value")+""==n+"";l.toggleClass("checked",c)}),e.find(".note-current-line-height").text(n)}}updateBtnStates(t,e){$.each(e,(o,n)=>{this.ui.toggleBtnActive(t.find(o),n())})}tableMoveHandler(t){const o=$(t.target.parentNode),n=o.next(),s=o.find(".note-dimension-picker-mousecatcher"),a=o.find(".note-dimension-picker-highlighted"),l=o.find(".note-dimension-picker-unhighlighted");let c;if(t.offsetX===void 0){const d=$(t.target).offset();c={x:t.pageX-d.left,y:t.pageY-d.top}}else c={x:t.offsetX,y:t.offsetY};const h={c:Math.ceil(c.x/18)||1,r:Math.ceil(c.y/18)||1};a.css({width:h.c+"em",height:h.r+"em"}),s.data("value",h.c+"x"+h.r),h.c>3&&h.c<this.options.insertTableMaxSize.col&&l.css({width:h.c+1+"em"}),h.r>3&&h.r<this.options.insertTableMaxSize.row&&l.css({height:h.r+1+"em"}),n.html(h.c+" x "+h.r)}}class Zo{constructor(t){this.context=t,this.$window=$(window),this.$document=$(document),this.ui=$.summernote.ui,this.$note=t.layoutInfo.note,this.$editor=t.layoutInfo.editor,this.$toolbar=t.layoutInfo.toolbar,this.$editable=t.layoutInfo.editable,this.$statusbar=t.layoutInfo.statusbar,this.options=t.options,this.isFollowing=!1,this.followScroll=this.followScroll.bind(this)}shouldInitialize(){return!this.options.airMode}initialize(){this.options.toolbar=this.options.toolbar||[],this.options.toolbar.length?this.context.invoke("buttons.build",this.$toolbar,this.options.toolbar):this.$toolbar.hide(),this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.changeContainer(!1),this.$note.on("summernote.keyup summernote.mouseup summernote.change",()=>{this.context.invoke("buttons.updateCurrentStyle")}),this.context.invoke("buttons.updateCurrentStyle"),this.options.followingToolbar&&this.$window.on("scroll resize",this.followScroll)}destroy(){this.$toolbar.children().remove(),this.options.followingToolbar&&this.$window.off("scroll resize",this.followScroll)}followScroll(){if(this.$editor.hasClass("fullscreen"))return!1;const t=this.$editor.outerHeight(),e=this.$editor.width(),o=this.$toolbar.height(),n=this.$statusbar.height();let s=0;this.options.otherStaticBar&&(s=$(this.options.otherStaticBar).outerHeight());const a=this.$document.scrollTop(),l=this.$editor.offset().top,c=l+t,h=l-s,d=c-s-o-n;!this.isFollowing&&a>h&&a<d-o?(this.isFollowing=!0,this.$editable.css({marginTop:this.$toolbar.outerHeight()}),this.$toolbar.css({position:"fixed",top:s,width:e,zIndex:1e3})):this.isFollowing&&(a<h||a>d)&&(this.isFollowing=!1,this.$toolbar.css({position:"relative",top:0,width:"100%",zIndex:"auto"}),this.$editable.css({marginTop:""}))}changeContainer(t){t?this.$toolbar.prependTo(this.$editor):this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.options.followingToolbar&&this.followScroll()}updateFullscreen(t){this.ui.toggleBtnActive(this.$toolbar.find(".btn-fullscreen"),t),this.changeContainer(t)}updateCodeview(t){this.ui.toggleBtnActive(this.$toolbar.find(".btn-codeview"),t),t?this.deactivate():this.activate()}activate(t){let e=this.$toolbar.find("button");t||(e=e.not(".note-codeview-keep")),this.ui.toggleBtn(e,!0)}deactivate(t){let e=this.$toolbar.find("button");t||(e=e.not(".note-codeview-keep")),this.ui.toggleBtn(e,!1)}}const Yo=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,Xo=/^(\+?\d{1,3}[\s-]?)?(\d{1,4})[\s-]?(\d{1,4})[\s-]?(\d{1,4})$/,Qo=/^([A-Za-z][A-Za-z0-9+-.]*\:|#|\/)/;class Jo{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo,t.memo("help.linkDialog.show",this.options.langInfo.help["linkDialog.show"])}initialize(){const t=this.options.dialogsInBody?this.$body:this.options.container,e=['<div class="form-group note-form-group">',`<label for="note-dialog-link-txt-${this.options.id}" class="note-form-label">${this.lang.link.textToDisplay}</label>`,`<input id="note-dialog-link-txt-${this.options.id}" class="note-link-text form-control note-form-control note-input" type="text"/>`,"</div>",'<div class="form-group note-form-group">',`<label for="note-dialog-link-url-${this.options.id}" class="note-form-label">${this.lang.link.url}</label>`,`<input id="note-dialog-link-url-${this.options.id}" class="note-link-url form-control note-form-control note-input" type="text" value="http://"/>`,"</div>",this.options.disableLinkTarget?"":$("<div></div>").append(this.ui.checkbox({className:"sn-checkbox-open-in-new-window",text:this.lang.link.openInNewWindow,checked:!0}).render()).html()].join(""),n=`<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary note-link-btn" value="${this.lang.link.insert}" disabled>`;this.$dialog=this.ui.dialog({className:"link-dialog",title:this.lang.link.insert,fade:this.options.dialogsFade,body:e,footer:n}).render().appendTo(t)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}bindEnterKey(t,e){t.on("keypress",o=>{o.keyCode===w.code.ENTER&&(o.preventDefault(),e.trigger("click"))})}checkLinkUrl(t){return Yo.test(t)?"mailto://"+t:Xo.test(t)?"tel://"+t:Qo.test(t)?t:"http://"+t}onCheckLinkUrl(t){t.on("blur",e=>{e.target.value=e.target.value==""?"":this.checkLinkUrl(e.target.value)})}toggleLinkBtn(t,e,o){this.ui.toggleBtn(t,e.val()&&o.val())}showLinkDialog(t){return $.Deferred(e=>{const o=this.$dialog.find(".note-link-text"),n=this.$dialog.find(".note-link-url"),s=this.$dialog.find(".note-link-btn"),a=this.$dialog.find(".sn-checkbox-open-in-new-window input[type=checkbox]");this.ui.onDialogShown(this.$dialog,()=>{this.context.triggerEvent("dialog.shown"),!t.url&&v.isValidUrl(t.text)&&(t.url=this.checkLinkUrl(t.text)),o.on("input paste propertychange",()=>{let c=o.val(),h=document.createElement("div");h.innerText=c,c=h.innerHTML,t.text=c,this.toggleLinkBtn(s,o,n)}).val(t.text),n.on("input paste propertychange",()=>{t.text||o.val(n.val()),this.toggleLinkBtn(s,o,n)}).val(t.url),S.isSupportTouch||n.trigger("focus"),this.toggleLinkBtn(s,o,n),this.bindEnterKey(n,s),this.bindEnterKey(o,s),this.onCheckLinkUrl(n);const l=t.isNewWindow!==void 0?t.isNewWindow:this.context.options.linkTargetBlank;a.prop("checked",l),s.one("click",c=>{c.preventDefault(),e.resolve({range:t.range,url:n.val(),text:o.val(),isNewWindow:a.is(":checked")}),this.ui.hideDialog(this.$dialog)})}),this.ui.onDialogHidden(this.$dialog,()=>{o.off(),n.off(),s.off(),e.state()==="pending"&&e.reject()}),this.ui.showDialog(this.$dialog)}).promise()}show(){const t=this.context.invoke("editor.getLinkInfo");this.context.invoke("editor.saveRange"),this.showLinkDialog(t).then(e=>{this.context.invoke("editor.restoreRange"),this.context.invoke("editor.createLink",e)}).fail(()=>{this.context.invoke("editor.restoreRange")})}}class ti{constructor(t){this.context=t,this.ui=$.summernote.ui,this.options=t.options,this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":()=>{this.update()},"summernote.disable summernote.dialog.shown":()=>{this.hide()},"summernote.blur":(e,o)=>{o.originalEvent&&o.originalEvent.relatedTarget?this.$popover[0].contains(o.originalEvent.relatedTarget)||this.hide():this.hide()}}}shouldInitialize(){return!u.isEmpty(this.options.popover.link)}initialize(){this.$popover=this.ui.popover({className:"note-link-popover",callback:e=>{e.find(".popover-content,.note-popover-content").prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo(this.options.container);const t=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",t,this.options.popover.link),this.$popover.on("mousedown",e=>{e.preventDefault()})}destroy(){this.$popover.remove()}update(){if(!this.context.invoke("editor.hasFocus")){this.hide();return}const t=this.context.invoke("editor.getLastRange");if(t.isCollapsed()&&t.isOnAnchor()){const e=r.ancestor(t.sc,r.isAnchor),o=$(e).attr("href");this.$popover.find("a").attr("href",o).text(o);const n=r.posFromPlaceholder(e),s=$(this.options.container).offset();n.top-=s.top,n.left-=s.left,this.$popover.css({display:"block",left:n.left,top:n.top})}else this.hide()}hide(){this.$popover.hide()}}class ei{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}initialize(){let t="";if(this.options.maximumImageFileSize){const a=Math.floor(Math.log(this.options.maximumImageFileSize)/Math.log(1024)),l=(this.options.maximumImageFileSize/Math.pow(1024,a)).toFixed(2)*1+" "+" KMGTP"[a]+"B";t=`<small>${this.lang.image.maximumFileSize+" : "+l}</small>`}const e=this.options.dialogsInBody?this.$body:this.options.container,o=['<div class="form-group note-form-group note-group-select-from-files">','<label for="note-dialog-image-file-'+this.options.id+'" class="note-form-label">'+this.lang.image.selectFromFiles+"</label>",'<input id="note-dialog-image-file-'+this.options.id+'" class="note-image-input form-control-file note-form-control note-input" ',' type="file" name="files" accept="'+this.options.acceptImageFileTypes+'" multiple="multiple"/>',t,"</div>",'<div class="form-group note-group-image-url">','<label for="note-dialog-image-url-'+this.options.id+'" class="note-form-label">'+this.lang.image.url+"</label>",'<input id="note-dialog-image-url-'+this.options.id+'" class="note-image-url form-control note-form-control note-input" type="text"/>',"</div>"].join(""),s=`<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary note-image-btn" value="${this.lang.image.insert}" disabled>`;this.$dialog=this.ui.dialog({title:this.lang.image.insert,fade:this.options.dialogsFade,body:o,footer:s}).render().appendTo(e)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}bindEnterKey(t,e){t.on("keypress",o=>{o.keyCode===w.code.ENTER&&(o.preventDefault(),e.trigger("click"))})}show(){this.context.invoke("editor.saveRange"),this.showImageDialog().then(t=>{this.ui.hideDialog(this.$dialog),this.context.invoke("editor.restoreRange"),typeof t=="string"?this.options.callbacks.onImageLinkInsert?this.context.triggerEvent("image.link.insert",t):this.context.invoke("editor.insertImage",t):this.context.invoke("editor.insertImagesOrCallback",t)}).fail(()=>{this.context.invoke("editor.restoreRange")})}showImageDialog(){return $.Deferred(t=>{const e=this.$dialog.find(".note-image-input"),o=this.$dialog.find(".note-image-url"),n=this.$dialog.find(".note-image-btn");this.ui.onDialogShown(this.$dialog,()=>{this.context.triggerEvent("dialog.shown"),e.replaceWith(e.clone().on("change",s=>{t.resolve(s.target.files||s.target.value)}).val("")),o.on("input paste propertychange",()=>{this.ui.toggleBtn(n,o.val())}).val(""),S.isSupportTouch||o.trigger("focus"),n.on("click",s=>{s.preventDefault(),t.resolve(o.val())}),this.bindEnterKey(o,n)}),this.ui.onDialogHidden(this.$dialog,()=>{e.off(),o.off(),n.off(),t.state()==="pending"&&t.reject()}),this.ui.showDialog(this.$dialog)})}}class oi{constructor(t){this.context=t,this.ui=$.summernote.ui,this.editable=t.layoutInfo.editable[0],this.options=t.options,this.events={"summernote.disable summernote.dialog.shown":()=>{this.hide()},"summernote.blur":(e,o)=>{o.originalEvent&&o.originalEvent.relatedTarget?this.$popover[0].contains(o.originalEvent.relatedTarget)||this.hide():this.hide()}}}shouldInitialize(){return!u.isEmpty(this.options.popover.image)}initialize(){this.$popover=this.ui.popover({className:"note-image-popover"}).render().appendTo(this.options.container);const t=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",t,this.options.popover.image),this.$popover.on("mousedown",e=>{e.preventDefault()})}destroy(){this.$popover.remove()}update(t,e){if(r.isImg(t)){const o=$(t).offset(),n=$(this.options.container).offset();let s={};this.options.popatmouse?(s.left=e.pageX-20,s.top=e.pageY):s=o,s.top-=n.top,s.left-=n.left,this.$popover.css({display:"block",left:s.left,top:s.top})}else this.hide()}hide(){this.$popover.hide()}}class ii{constructor(t){this.context=t,this.ui=$.summernote.ui,this.options=t.options,this.events={"summernote.mousedown":(e,o)=>{this.update(o.target)},"summernote.keyup summernote.scroll summernote.change":()=>{this.update()},"summernote.disable summernote.dialog.shown":()=>{this.hide()},"summernote.blur":(e,o)=>{o.originalEvent&&o.originalEvent.relatedTarget?this.$popover[0].contains(o.originalEvent.relatedTarget)||this.hide():this.hide()}}}shouldInitialize(){return!u.isEmpty(this.options.popover.table)}initialize(){this.$popover=this.ui.popover({className:"note-table-popover"}).render().appendTo(this.options.container);const t=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",t,this.options.popover.table),S.isFF&&document.execCommand("enableInlineTableEditing",!1,!1),this.$popover.on("mousedown",e=>{e.preventDefault()})}destroy(){this.$popover.remove()}update(t){if(this.context.isDisabled())return!1;const e=r.isCell(t)||r.isCell(t==null?void 0:t.parentElement);if(e){const o=r.posFromPlaceholder(t),n=$(this.options.container).offset();o.top-=n.top,o.left-=n.left,this.$popover.css({display:"block",left:o.left,top:o.top})}else this.hide();return e}hide(){this.$popover.hide()}}class ni{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}initialize(){const t=this.options.dialogsInBody?this.$body:this.options.container,e=['<div class="form-group note-form-group row-fluid">',`<label for="note-dialog-video-url-${this.options.id}" class="note-form-label">${this.lang.video.url} <small class="text-muted">${this.lang.video.providers}</small></label>`,`<input id="note-dialog-video-url-${this.options.id}" class="note-video-url form-control note-form-control note-input" type="text"/>`,"</div>"].join(""),n=`<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary note-video-btn" value="${this.lang.video.insert}" disabled>`;this.$dialog=this.ui.dialog({title:this.lang.video.insert,fade:this.options.dialogsFade,body:e,footer:n}).render().appendTo(t)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}bindEnterKey(t,e){t.on("keypress",o=>{o.keyCode===w.code.ENTER&&(o.preventDefault(),e.trigger("click"))})}createVideoNode(t){const e=/(?:youtu\.be\/|youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=|shorts\/|live\/))([^&\n?]+)(?:.*[?&]t=([^&\n]+))?.*/,o=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/,n=t.match(e),s=/(?:\.|\/\/)drive\.google\.com\/file\/d\/(.[a-zA-Z0-9_-]*)\/view/,a=t.match(s),l=/(?:www\.|\/\/)instagram\.com\/(reel|p)\/(.[a-zA-Z0-9_-]*)/,c=t.match(l),h=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/,d=t.match(h),f=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/,C=t.match(f),b=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,T=t.match(b),A=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,O=t.match(A),p=/\/\/(.*)\/videos\/watch\/([^?]*)(?:\?(?:start=(\w*))?(?:&stop=(\w*))?(?:&loop=([10]))?(?:&autoplay=([10]))?(?:&muted=([10]))?)?/,m=t.match(p),x=/\/\/v\.qq\.com.*?vid=(.+)/,y=t.match(x),U=/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/,M=t.match(U),j=/^.+.(mp4|m4v)$/,z=t.match(j),P=/^.+.(ogg|ogv)$/,V=t.match(P),Ci=/^.+.(webm)$/,ki=t.match(Ci),wi=/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/,$t=t.match(wi);let L;if(n&&n[1].length===11){const Tt=n[1];var Q=0;if(typeof n[2]<"u"){const Et=n[2].match(o);if(Et)for(var ne=[3600,60,1],J=0,xi=ne.length;J<xi;J++)Q+=typeof Et[J+1]<"u"?ne[J]*parseInt(Et[J+1],10):0;else Q=parseInt(n[2],10)}L=$("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+Tt+(Q>0?"?start="+Q:"")).attr("width","640").attr("height","360")}else if(a&&a[0].length)L=$("<iframe>").attr("frameborder",0).attr("src","https://drive.google.com/file/d/"+a[1]+"/preview").attr("width","640").attr("height","480");else if(c&&c[0].length)L=$("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+c[2]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(d&&d[0].length)L=$("<iframe>").attr("frameborder",0).attr("src",d[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(C&&C[3].length)L=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+C[3]).attr("width","640").attr("height","360");else if(T&&T[2].length)L=$("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+T[2]).attr("width","640").attr("height","360");else if(O&&O[1].length)L=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+O[1]);else if(m&&m[0].length){var St=0;m[2]!=="undefined"&&(St=m[2]);var se=0;m[3]!=="undefined"&&(se=m[3]);var re=0;m[4]!=="undefined"&&(re=m[4]);var ae=0;m[5]!=="undefined"&&(ae=m[5]);var le=0;m[6]!=="undefined"&&(le=m[6]),L=$('<iframe allowfullscreen sandbox="allow-same-origin allow-scripts allow-popups">').attr("frameborder",0).attr("src","//"+m[1]+"/videos/embed/"+m[2]+"?loop="+re+"&autoplay="+ae+"&muted="+le+(St>0?"&start="+St:"")+(se>0?"&end="+Q:"")).attr("width","560").attr("height","315")}else if(y&&y[1].length||M&&M[2].length){const Tt=y&&y[1].length?y[1]:M[2];L=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","https://v.qq.com/txp/iframe/player.html?vid="+Tt+"&amp;auto=0")}else if(z||V||ki)L=$("<video controls>").attr("src",t).attr("width","640").attr("height","360");else if($t&&$t[0].length)L=$("<iframe>").attr("frameborder",0).attr("src","https://www.facebook.com/plugins/video.php?href="+encodeURIComponent($t[0])+"&show_text=0&width=560").attr("width","560").attr("height","301").attr("scrolling","no").attr("allowtransparency","true");else return!1;return L.addClass("note-video-clip"),L[0]}show(){const t=this.context.invoke("editor.getSelectedText");this.context.invoke("editor.saveRange"),this.showVideoDialog(t).then(e=>{this.ui.hideDialog(this.$dialog),this.context.invoke("editor.restoreRange");const o=this.createVideoNode(e);o&&this.context.invoke("editor.insertNode",o)}).fail(()=>{this.context.invoke("editor.restoreRange")})}showVideoDialog(){return $.Deferred(t=>{const e=this.$dialog.find(".note-video-url"),o=this.$dialog.find(".note-video-btn");this.ui.onDialogShown(this.$dialog,()=>{this.context.triggerEvent("dialog.shown"),e.on("input paste propertychange",()=>{this.ui.toggleBtn(o,e.val())}),S.isSupportTouch||e.trigger("focus"),o.on("click",n=>{n.preventDefault(),t.resolve(e.val())}),this.bindEnterKey(e,o)}),this.ui.onDialogHidden(this.$dialog,()=>{e.off(),o.off(),t.state()==="pending"&&t.reject()}),this.ui.showDialog(this.$dialog)})}}class si{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}initialize(){const t=this.options.dialogsInBody?this.$body:this.options.container,e=['<p class="text-center">','<a href="http://summernote.org/" target="_blank" rel="noopener noreferrer">Summernote @@VERSION@@</a> Â· ','<a href="https://github.com/summernote/summernote" target="_blank" rel="noopener noreferrer">Project</a> Â· ','<a href="https://github.com/summernote/summernote/issues" target="_blank" rel="noopener noreferrer">Issues</a>',"</p>"].join("");this.$dialog=this.ui.dialog({title:this.lang.options.help,fade:this.options.dialogsFade,body:this.createShortcutList(),footer:e,callback:o=>{o.find(".modal-body,.note-modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(t)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}createShortcutList(){const t=this.options.keyMap[S.isMac?"mac":"pc"];return Object.keys(t).map(e=>{const o=t[e],n=$('<div><div class="help-list-item"></div></div>');return n.append($("<label><kbd>"+e+"</kdb></label>").css({width:180,"margin-right":10})).append($("<span></span>").html(this.context.memo("help."+o)||o)),n.html()}).join("")}showHelpDialog(){return $.Deferred(t=>{this.ui.onDialogShown(this.$dialog,()=>{this.context.triggerEvent("dialog.shown"),t.resolve()}),this.ui.showDialog(this.$dialog)}).promise()}show(){this.context.invoke("editor.saveRange"),this.showHelpDialog().then(()=>{this.context.invoke("editor.restoreRange")})}}const ri=-5,ai=5;class li{constructor(t){this.context=t,this.ui=$.summernote.ui,this.options=t.options,this.hidable=!0,this.onContextmenu=!1,this.pageX=null,this.pageY=null,this.events={"summernote.contextmenu":e=>{this.options.editing&&(e.preventDefault(),e.stopPropagation(),this.onContextmenu=!0,this.update(!0))},"summernote.mousedown":(e,o)=>{this.pageX=o.pageX,this.pageY=o.pageY},"summernote.keyup summernote.mouseup summernote.scroll":(e,o)=>{if(this.options.editing&&!this.onContextmenu){if(o.type=="keyup"){let s=this.context.invoke("editor.getLastRange").getWordRange();const a=v.rect2bnd(u.last(s.getClientRects()));this.pageX=a.left,this.pageY=a.top}else this.pageX=o.pageX,this.pageY=o.pageY;this.update()}this.onContextmenu=!1},"summernote.disable summernote.change summernote.dialog.shown summernote.blur":()=>{this.hide()},"summernote.focusout":()=>{this.$popover.is(":active,:focus")||this.hide()}}}shouldInitialize(){return this.options.airMode&&!u.isEmpty(this.options.popover.air)}initialize(){this.$popover=this.ui.popover({className:"note-air-popover"}).render().appendTo(this.options.container);const t=this.$popover.find(".popover-content");this.context.invoke("buttons.build",t,this.options.popover.air),this.$popover.on("mousedown",()=>{this.hidable=!1}),this.$popover.on("mouseup",()=>{this.hidable=!0})}destroy(){this.$popover.remove()}update(t){const e=this.context.invoke("editor.currentStyle");if(e.range&&(!e.range.isCollapsed()||t)){let o={left:this.pageX,top:this.pageY};const n=$(this.options.container).offset();o.top-=n.top,o.left-=n.left,this.$popover.css({display:"block",left:Math.max(o.left,0)+ri,top:o.top+ai}),this.context.invoke("buttons.updateCurrentStyle",this.$popover)}else this.hide()}updateCodeview(t){this.ui.toggleBtnActive(this.$popover.find(".btn-codeview"),t),t&&this.hide()}hide(){this.hidable&&this.$popover.hide()}}const te=5;class ci{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$editable=t.layoutInfo.editable,this.options=t.options,this.hint=this.options.hint||[],this.direction=this.options.hintDirection||"bottom",this.hints=Array.isArray(this.hint)?this.hint:[this.hint],this.events={"summernote.keyup":(e,o)=>{o.isDefaultPrevented()||this.handleKeyup(o)},"summernote.keydown":(e,o)=>{this.handleKeydown(o)},"summernote.disable summernote.dialog.shown summernote.blur":()=>{this.hide()}}}shouldInitialize(){return this.hints.length>0}initialize(){this.lastWordRange=null,this.matchingWord=null,this.$popover=this.ui.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo(this.options.container),this.$popover.hide(),this.$content=this.$popover.find(".popover-content,.note-popover-content"),this.$content.on("click",".note-hint-item",t=>{this.$content.find(".active").removeClass("active"),$(t.currentTarget).addClass("active"),this.replace()}),this.$popover.on("mousedown",t=>{t.preventDefault()})}destroy(){this.$popover.remove()}selectItem(t){this.$content.find(".active").removeClass("active"),t.addClass("active"),this.$content[0].scrollTop=t[0].offsetTop-this.$content.innerHeight()/2}moveDown(){const t=this.$content.find(".note-hint-item.active"),e=t.next();if(e.length)this.selectItem(e);else{let o=t.parent().next();o.length||(o=this.$content.find(".note-hint-group").first()),this.selectItem(o.find(".note-hint-item").first())}}moveUp(){const t=this.$content.find(".note-hint-item.active"),e=t.prev();if(e.length)this.selectItem(e);else{let o=t.parent().prev();o.length||(o=this.$content.find(".note-hint-group").last()),this.selectItem(o.find(".note-hint-item").last())}}replace(){const t=this.$content.find(".note-hint-item.active");if(t.length){var e=this.nodeFromItem(t);if(this.matchingWord!==null&&this.matchingWord.length===0)this.lastWordRange.so=this.lastWordRange.eo;else if(this.matchingWord!==null&&this.matchingWord.length>0&&!this.lastWordRange.isCollapsed()){let n=this.lastWordRange.eo-this.lastWordRange.so-this.matchingWord.length;n>0&&(this.lastWordRange.so+=n)}if(this.lastWordRange.insertNode(e),this.options.hintSelect==="next"){var o=document.createTextNode("");$(e).after(o),k.createFromNodeBefore(o).select()}else k.createFromNodeAfter(e).select();this.lastWordRange=null,this.hide(),this.context.invoke("editor.focus"),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}}nodeFromItem(t){const e=this.hints[t.data("index")],o=t.data("item");let n=e.content?e.content(o):o;return typeof n=="string"&&(n=r.createText(n)),n}createItemTemplates(t,e){const o=this.hints[t];return e.map((n,s)=>{const a=$('<div class="note-hint-item"></div>');return a.append(o.template?o.template(n):n+""),a.data({index:t,item:n}),t===0&&s===0&&a.addClass("active"),a})}handleKeydown(t){this.$popover.is(":visible")&&(t.keyCode===w.code.ENTER?(t.preventDefault(),this.replace()):t.keyCode===w.code.UP?(t.preventDefault(),this.moveUp()):t.keyCode===w.code.DOWN&&(t.preventDefault(),this.moveDown()))}searchKeyword(t,e,o){const n=this.hints[t];if(n&&n.match.test(e)&&n.search){const s=n.match.exec(e);this.matchingWord=s[0],n.search(s[1],o)}else o()}createGroup(t,e){const o=$('<div class="note-hint-group note-hint-group-'+t+'"></div>');return this.searchKeyword(t,e,n=>{n=n||[],n.length&&(o.html(this.createItemTemplates(t,n)),this.show())}),o}handleKeyup(t){if(!u.contains([w.code.ENTER,w.code.UP,w.code.DOWN],t.keyCode)){let e=this.context.invoke("editor.getLastRange"),o,n;if(this.options.hintMode==="words"){if(o=e.getWordsRange(e),n=o.toString(),this.hints.forEach(s=>{if(s.match.test(n))return o=e.getWordsMatchRange(s.match),!1}),!o){this.hide();return}n=o.toString()}else o=e.getWordRange(),n=o.toString();if(this.hints.length&&n){this.$content.empty();const s=v.rect2bnd(u.last(o.getClientRects())),a=$(this.options.container).offset();s&&(s.top-=a.top,s.left-=a.left,this.$popover.hide(),this.lastWordRange=o,this.hints.forEach((l,c)=>{l.match.test(n)&&this.createGroup(c,n).appendTo(this.$content)}),this.$content.find(".note-hint-item").first().addClass("active"),this.direction==="top"?this.$popover.css({left:s.left,top:s.top-this.$popover.outerHeight()-te}):this.$popover.css({left:s.left,top:s.top+s.height+te}))}else this.hide()}}show(){this.$popover.show()}hide(){this.$popover.hide()}}$.summernote=$.extend($.summernote,{version:"@@VERSION@@",plugins:{},dom:r,range:k,lists:u,options:{langInfo:$.summernote.lang["en-US"],editing:!0,modules:{editor:Ho,clipboard:Do,dropzone:Mo,codeview:zo,statusbar:Bo,fullscreen:Oo,handle:Uo,hintPopover:ci,autoLink:Ko,autoSync:Vo,autoReplace:qo,placeholder:_o,buttons:Go,toolbar:Zo,linkDialog:Jo,linkPopover:ti,imageDialog:ei,imagePopover:oi,tablePopover:ii,videoDialog:ni,helpDialog:si,airPopover:li},buttons:{},lang:"en-US",followingToolbar:!1,toolbarPosition:"top",otherStaticBar:"",codeviewKeepButton:!1,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popatmouse:!0,popover:{image:[["resize",["resizeFull","resizeHalf","resizeQuarter","resizeNone"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]],["view",["fullscreen","codeview"]]]},linkAddNoReferrer:!1,addLinkNoOpener:!1,airMode:!1,overrideContextMenu:!1,width:null,height:null,linkTargetBlank:!0,focus:!1,tabDisable:!1,tabSize:4,styleWithCSS:!1,shortcuts:!0,textareaAutoSync:!0,tooltip:"auto",container:null,maxTextLength:0,blockquoteBreakingLevel:2,spellCheck:!0,disableGrammar:!1,placeholder:null,inheritPlaceholder:!1,recordEveryKeystroke:!1,historyLimit:200,showDomainOnlyForAutolink:!1,hintMode:"word",hintSelect:"after",hintDirection:"bottom",styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],addDefaultFonts:!0,fontSizes:["8","9","10","11","12","14","18","24","36"],fontSizeUnits:["px","pt"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],colorsName:[["Black","Tundora","Dove Gray","Star Dust","Pale Slate","Gallery","Alabaster","White"],["Red","Orange Peel","Yellow","Green","Cyan","Blue","Electric Violet","Magenta"],["Azalea","Karry","Egg White","Zanah","Botticelli","Tropical Blue","Mischka","Twilight"],["Tonys Pink","Peach Orange","Cream Brulee","Sprout","Casper","Perano","Cold Purple","Careys Pink"],["Mandy","Rajah","Dandelion","Olivine","Gulf Stream","Viking","Blue Marguerite","Puce"],["Guardsman Red","Fire Bush","Golden Dream","Chelsea Cucumber","Smalt Blue","Boston Blue","Butterfly Bush","Cadillac"],["Sangria","Mai Tai","Buddha Gold","Forest Green","Eden","Venice Blue","Meteorite","Claret"],["Rosewood","Cinnamon","Olive","Parsley","Tiber","Midnight Blue","Valentino","Loulou"]],colorButton:{foreColor:"#000000",backColor:"#FFFF00"},lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,acceptImageFileTypes:"image/*",allowClipboardImagePasting:!0,callbacks:{onBeforeCommand:null,onBlur:null,onBlurCodeview:null,onChange:null,onChangeCodeview:null,onDialogShown:null,onEnter:null,onFocus:null,onImageLinkInsert:null,onImageUpload:null,onImageUploadError:null,onInit:null,onKeydown:null,onKeyup:null,onMousedown:null,onMouseup:null,onPaste:null,onScroll:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},codeviewFilter:!0,codeviewFilterRegex:/<\/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|ilayer|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|t(?:itle|extarea)|xml)[^>]*?>/gi,codeviewIframeFilter:!0,codeviewIframeWhitelistSrc:[],codeviewIframeWhitelistSrcBase:["www.youtube.com","www.youtube-nocookie.com","www.facebook.com","vine.co","instagram.com","player.vimeo.com","www.dailymotion.com","player.youku.com","jumpingbean.tv","v.qq.com"],keyMap:{pc:{ESC:"escape",ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ESC:"escape",ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",rowBelow:"note-icon-row-below",colBefore:"note-icon-col-before",colAfter:"note-icon-col-after",rowAbove:"note-icon-row-above",rowRemove:"note-icon-row-remove",colRemove:"note-icon-col-remove",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",floatLeft:"note-icon-float-left",floatRight:"note-icon-float-right",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-menu-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",rollback:"note-icon-rollback",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}});class hi{constructor(t,e,o,n){this.markup=t,this.children=e,this.options=o,this.callback=n}render(t){const e=$(this.markup);if(this.options&&this.options.contents&&e.html(this.options.contents),this.options&&this.options.className&&e.addClass(this.options.className),this.options&&this.options.data&&$.each(this.options.data,(o,n)=>{e.attr("data-"+o,n)}),this.options&&this.options.click&&e.on("click",this.options.click),this.children){const o=e.find(".note-children-container");this.children.forEach(n=>{n.render(o.length?o:e)})}return this.callback&&this.callback(e,this.options),this.options&&this.options.callback&&this.options.callback(e),t&&t.append(e),e}}const I={create:(i,t)=>function(){const e=typeof arguments[1]=="object"?arguments[1]:arguments[0];let o=Array.isArray(arguments[0])?arguments[0]:[];return e&&e.children&&(o=e.children),new hi(i,o,e,t)}},kt=I.create('<div class="note-editor note-frame card"></div>'),wt=I.create('<div class="note-toolbar card-header" role="toolbar"></div>'),st=I.create('<div class="note-editing-area"></div>'),rt=I.create('<textarea class="note-codable" aria-multiline="true"></textarea>'),xt=I.create('<div class="note-editable card-block" contentEditable="true" role="textbox" aria-multiline="true"/>'),yt=I.create(['<output class="note-status-output" role="status" aria-live="polite"></output>','<div class="note-statusbar" role="status">','<div class="note-resizebar" aria-label="Resize">','<div class="note-icon-bar"></div>','<div class="note-icon-bar"></div>','<div class="note-icon-bar"></div>',"</div>","</div>"].join("")),ee=I.create('<div class="note-editor note-airframe"></div>'),oe=I.create(['<div class="note-editable" contentEditable="true" role="textbox" aria-multiline="true"></div>','<output class="note-status-output" role="status" aria-live="polite"></output>'].join("")),di=I.create('<div class="note-btn-group btn-group">'),ui=I.create('<div class="note-dropdown-menu dropdown-menu" role="list">',function(i,t){const e=Array.isArray(t.items)?t.items.map(function(o){const n=typeof o=="string"?o:o.value||"",s=t.template?t.template(o):o,a=typeof o=="object"?o.option:void 0,l='data-value="'+n+'"',c=a!==void 0?' data-option="'+a+'"':"";return'<a class="dropdown-item" href="#" '+(l+c)+' role="listitem" aria-label="'+n+'">'+s+"</a>"}).join(""):t.items;i.html(e).attr({"aria-label":t.title}),t&&t.codeviewKeepButton&&i.addClass("note-codeview-keep")}),fi=function(i){return i},pi=I.create('<div class="note-dropdown-menu dropdown-menu note-check" role="list">',function(i,t){const e=Array.isArray(t.items)?t.items.map(function(o){const n=typeof o=="string"?o:o.value||"",s=t.template?t.template(o):o;return'<a class="dropdown-item" href="#" data-value="'+n+'" role="listitem" aria-label="'+o+'">'+ie(t.checkClassName)+" "+s+"</a>"}).join(""):t.items;i.html(e).attr({"aria-label":t.title}),t&&t.codeviewKeepButton&&i.addClass("note-codeview-keep")}),mi=I.create('<div class="modal note-modal" aria-hidden="false" tabindex="-1" role="dialog"></div>',function(i,t){t.fade&&i.addClass("fade"),i.attr({"aria-label":t.title}),i.html(['<div class="modal-dialog">','<div class="modal-content">',t.title?'<div class="modal-header"><h4 class="modal-title">'+t.title+'</h4><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" aria-hidden="true"></button></div>':"",'<div class="modal-body">'+t.body+"</div>",t.footer?'<div class="modal-footer">'+t.footer+"</div>":"","</div>","</div>"].join(""))}),gi=I.create(['<div class="note-popover popover bs-popover-auto show">','<div class="popover-arrow"></div>','<div class="popover-body note-popover-content note-children-container"></div>',"</div>"].join(""),function(i,t){const e=typeof t.direction<"u"?t.direction:"bottom";i.attr("data-popper-placement",e),t.hideArrow&&i.find(".popover-arrow").hide()}),bi=I.create('<div class="form-check"></div>',function(i,t){i.html(['<label class="form-check-label"'+(t.id?' for="note-'+t.id+'"':"")+">",'<input type="checkbox" class="form-check-input"'+(t.id?' id="note-'+t.id+'"':""),t.checked?" checked":"",' aria-label="'+(t.text?t.text:"")+'"',' aria-checked="'+(t.checked?"true":"false")+'"/>'," "+(t.text?t.text:"")+"</label>"].join(""))}),ie=function(i,t){return i.match(/^</)?i:(t=t||"i","<"+t+' class="'+i+'"></'+t+">")},vi=function(i){return{editor:kt,toolbar:wt,editingArea:st,codable:rt,editable:xt,statusbar:yt,airEditor:ee,airEditable:oe,buttonGroup:di,dropdown:ui,dropdownButtonContents:fi,dropdownCheck:pi,dialog:mi,popover:gi,icon:ie,checkbox:bi,options:i,palette:function(t,e){return I.create('<div class="note-color-palette"></div>',function(o,n){const s=[];for(let l=0,c=n.colors.length;l<c;l++){const h=n.eventName,d=n.colors[l],f=n.colorsName[l],C=[];for(let b=0,T=d.length;b<T;b++){const A=d[b],O=f[b];C.push(['<button type="button" class="note-color-btn"','style="background-color:',A,'" ','data-event="',h,'" ','data-value="',A,'" ','title="',O,'" ','aria-label="',O,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}s.push('<div class="note-color-row">'+C.join("")+"</div>")}if(o.html(s.join("")),n.tooltip){var a={container:n.container||i.container,trigger:"hover",placement:"bottom"};o.tooltip({selector:".note-color-btn",...a})}})(t,e)},button:function(t,e){return I.create('<button type="button" class="note-btn btn btn-outline-secondary btn-sm" tabindex="-1">',function(o,n){n&&n.data&&n.data.toggle==="dropdown"?(o.removeAttr("data-toggle"),o.attr("data-bs-toggle","dropdown"),n&&n.tooltip&&o.attr({title:n.tooltip,"aria-label":n.tooltip})):n&&n.tooltip&&o.attr({title:n.tooltip,"aria-label":n.tooltip}).tooltip({container:n.container||i.container,trigger:"hover",placement:"bottom"}).on("click",s=>{$(s.currentTarget).tooltip("hide")}),n&&n.codeviewButton&&o.addClass("note-codeview-keep")})(t,e)},toggleBtn:function(t,e){t.toggleClass("disabled",!e),t.attr("disabled",!e)},toggleBtnActive:function(t,e){t.toggleClass("active",e)},onDialogShown:function(t,e){t.one("shown.bs.modal",e)},onDialogHidden:function(t,e){t.one("hidden.bs.modal",e)},showDialog:function(t){t.modal("show")},hideDialog:function(t){t.modal("hide")},createLayout:function(t){const e=(i.airMode?ee([st([rt(),oe()])]):i.toolbarPosition==="bottom"?kt([st([rt(),xt()]),wt(),yt()]):kt([wt(),st([rt(),xt()]),yt()])).render();return e.insertAfter(t),{note:t,editor:e,toolbar:e.find(".note-toolbar"),editingArea:e.find(".note-editing-area"),editable:e.find(".note-editable"),codable:e.find(".note-codable"),statusbar:e.find(".note-statusbar")}},removeLayout:function(t,e){t.html(e.editable.html()),e.editor.remove(),t.show()}}};$.summernote=$.extend($.summernote,{ui_template:vi,interface:"bs5"}),$.summernote.options.styleTags=["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"]})();
//# sourceMappingURL=summernote-bs5.min.js.map
